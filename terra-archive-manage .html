<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra Archive Manager 2.0 Ultimate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .fractal-button {
            @apply px-6 py-3 rounded-lg font-semibold text-white shadow-lg transform transition-all duration-300 hover:scale-105 hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-opacity-50;
        }
        
        .archive-item {
            @apply bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:scale-102;
        }
        
        .semantic-tag {
            @apply inline-block px-3 py-1 bg-gradient-to-r from-blue-500 to-purple-500 text-white text-sm rounded-full mr-2 mb-2 shadow-sm;
        }
        
        .definition-card {
            @apply bg-gradient-to-br from-teal-50 to-cyan-50 p-6 rounded-lg border border-teal-200 shadow-sm;
        }
        
        .encyclopedia-entry {
            @apply bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200 shadow-sm mb-4;
        }
        
        .tab-button {
            @apply px-6 py-3 font-semibold text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 transition-all duration-200;
        }
        
        .tab-button.active {
            @apply text-blue-600 border-blue-600;
        }
        
        .tab-content {
            @apply mt-8;
        }
        
        .modal {
            @apply fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50;
        }
        
        .modal-content {
            @apply bg-white rounded-lg p-8 max-w-2xl max-h-3/4 overflow-y-auto shadow-2xl;
        }
        
        .save-indicator {
            @apply fixed top-4 right-4 px-4 py-2 rounded-lg text-white font-semibold shadow-lg z-50 transition-all duration-300;
        }
        
        .save-indicator.saving {
            @apply bg-blue-500;
        }
        
        .save-indicator.saved {
            @apply bg-green-500;
        }
        
        .save-indicator.error {
            @apply bg-red-500;
        }
        
        .progress-bar {
            @apply w-full bg-gray-200 rounded-full h-4 shadow-inner;
        }
        
        .progress-fill {
            @apply bg-gradient-to-r from-blue-500 to-purple-500 h-4 rounded-full transition-all duration-300 shadow-sm;
        }
        
        .drop-zone {
            @apply border-4 border-dashed border-gray-300 rounded-lg p-12 text-center transition-all duration-300 hover:border-blue-400 hover:bg-blue-50;
        }
        
        .drop-zone.dragover {
            @apply border-blue-500 bg-blue-100;
        }
        
        .accessibility-high-contrast {
            @apply bg-black text-white;
        }
        
        .accessibility-large-text {
            font-size: 120% !important;
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .hidden {
            display: none !important;
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.5); }
            50% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.8); }
        }
        
        .pulse-glow {
            animation: pulse-glow 2s infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen" id="mainBody">
    <div id="saveIndicator" class="save-indicator saved hidden">‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ</div>
    
    <!-- Header -->
    <header class="gradient-bg text-white p-6 shadow-xl">
        <div class="container mx-auto">
            <div class="flex justify-between items-center mb-4">
                <div>
                    <h1 class="text-4xl font-bold mb-2">üåç Terra Archive Manager 2.0 Ultimate</h1>
                    <p class="text-blue-100">–§—Ä–∞–∫—Ç–∞–ª—å–Ω—ã–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä—Ö–∏–≤ L0-L7 ‚Ä¢ –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å ‚Ä¢ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-blue-200">–ê–≤—Ç–æ—Ä: –ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á</div>
                    <div class="text-xs text-blue-300">DID: aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890</div>
                    <div id="systemLevelIndicator" class="text-lg font-bold mt-2">üß¨ –£—Ä–æ–≤–µ–Ω—å: L0</div>
                </div>
            </div>
            
            <!-- Language and Accessibility Controls -->
            <div class="flex justify-between items-center">
                <div class="flex space-x-4">
                    <select id="languageSelect" class="px-3 py-2 bg-white bg-opacity-20 rounded-lg text-white border border-white border-opacity-30 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50">
                        <option value="uz">üá∫üáø O'zbek</option>
                        <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                        <option value="en">üá∫üá∏ English</option>
                        <option value="de">üá©üá™ Deutsch</option>
                    </select>
                    
                    <button id="accessibilityToggle" class="fractal-button bg-yellow-500 hover:bg-yellow-600 focus:ring-yellow-300">
                        ‚ôø –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
                    </button>
                    
                    <button id="dictionaryModeToggle" class="fractal-button bg-green-500 hover:bg-green-600 focus:ring-green-300">
                        üìö –°–ª–æ–≤–∞—Ä—å
                    </button>
                </div>
                
                <div class="flex space-x-2">
                    <button onclick="runCompatibilityCheck()" class="fractal-button bg-purple-500 hover:bg-purple-600 focus:ring-purple-300">
                        üîç –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
                    </button>
                    <button onclick="generateUltimateReport()" class="fractal-button bg-indigo-500 hover:bg-indigo-600 focus:ring-indigo-300">
                        üìä –û—Ç—á–µ—Ç
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-6">
        <!-- System Status -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800">üñ•Ô∏è –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
                <div class="flex space-x-2">
                    <button onclick="upgradeSystemLevel()" class="fractal-button bg-blue-500 hover:bg-blue-600 focus:ring-blue-300">
                        ‚¨ÜÔ∏è –ü–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
                    </button>
                    <button onclick="resetToL0()" class="fractal-button bg-gray-500 hover:bg-gray-600 focus:ring-gray-300">
                        üîÑ –°–±—Ä–æ—Å –∫ L0
                    </button>
                </div>
            </div>
            <div class="grid grid-cols-4 gap-4" id="systemStatus">
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div class="text-2xl font-bold text-blue-600" id="currentLevel">L0</div>
                    <div class="text-sm text-blue-700">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <div class="text-2xl font-bold text-green-600" id="archiveCount">0</div>
                    <div class="text-sm text-green-700">–ê—Ä—Ö–∏–≤–æ–≤</div>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <div class="text-2xl font-bold text-purple-600" id="analysisCount">0</div>
                    <div class="text-sm text-purple-700">–ê–Ω–∞–ª–∏–∑–æ–≤</div>
                </div>
                <div class="text-center p-4 bg-orange-50 rounded-lg">
                    <div class="text-2xl font-bold text-orange-600" id="storageUsed">0 KB</div>
                    <div class="text-sm text-orange-700">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –º–µ—Å—Ç–∞</div>
                </div>
            </div>
        </div>

        <!-- Archive Management -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞–º–∏</h2>
            
            <!-- Archive Request Form -->
            <div class="bg-gray-50 p-6 rounded-lg mb-6">
                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <label for="archiveRequest" class="block text-sm font-medium text-gray-700 mb-2">–ó–∞–ø—Ä–æ—Å –Ω–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ:</label>
                        <textarea 
                            id="archiveRequest" 
                            rows="4" 
                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="–û–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å..."></textarea>
                    </div>
                    <div>
                        <label for="requesterDID" class="block text-sm font-medium text-gray-700 mb-2">DID –∑–∞–ø—Ä–æ—Å—á–∏–∫–∞:</label>
                        <input 
                            type="text" 
                            id="requesterDID" 
                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            value="aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890">
                        
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª—ã:</label>
                            <input 
                                type="file" 
                                id="fileInput" 
                                multiple 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                onchange="handleFiles(this.files)">
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between items-center mt-6">
                    <button onclick="processArchiveRequest()" class="fractal-button bg-blue-500 hover:bg-blue-600 focus:ring-blue-300">
                        üóÑÔ∏è –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤
                    </button>
                    
                    <div class="flex space-x-2">
                        <button onclick="exportUltimateArchive()" class="fractal-button bg-green-500 hover:bg-green-600 focus:ring-green-300">
                            üíæ –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                        <button onclick="importUltimateArchive()" class="fractal-button bg-orange-500 hover:bg-orange-600 focus:ring-orange-300">
                            üì• –ò–º–ø–æ—Ä—Ç
                        </button>
                        <button onclick="createQuantumBackup()" class="fractal-button bg-purple-500 hover:bg-purple-600 focus:ring-purple-300">
                            ‚öõÔ∏è –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±—ç–∫–∞–ø
                        </button>
                    </div>
                </div>
            </div>

            <!-- Drag and Drop Zone -->
            <div 
                id="dropZone" 
                class="drop-zone" 
                ondrop="dropHandler(event)" 
                ondragover="dragOverHandler(event)" 
                ondragleave="dragLeaveHandler(event)">
                <div class="text-4xl mb-4">üìÅ</div>
                <h3 class="text-xl font-semibold text-gray-700 mb-2">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
                <p class="text-gray-500">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã" –≤—ã—à–µ</p>
            </div>

            <!-- Processing Progress -->
            <div id="processingProgress" class="hidden mt-6">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>
                <p id="progressText" class="text-center text-sm text-gray-600 mt-2">–û–±—Ä–∞–±–æ—Ç–∫–∞...</p>
            </div>
        </div>

        <!-- Search and Browse -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">üîç –ü–æ–∏—Å–∫ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
                <div class="flex space-x-2">
                    <button onclick="organizeAll()" class="fractal-button bg-teal-500 hover:bg-teal-600 focus:ring-teal-300">
                        üìÅ –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ
                    </button>
                    <button onclick="optimizeForCurrentLevel()" class="fractal-button bg-yellow-500 hover:bg-yellow-600 focus:ring-yellow-300">
                        üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-3 gap-4 mb-6">
                <div>
                    <label for="searchBox" class="block text-sm font-medium text-gray-700 mb-2">–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:</label>
                    <input 
                        type="text" 
                        id="searchBox" 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞..."
                        onkeyup="if(event.key === 'Enter') performCorpusSearch()">
                </div>
                <div>
                    <label for="searchMode" class="block text-sm font-medium text-gray-700 mb-2">–†–µ–∂–∏–º –ø–æ–∏—Å–∫–∞:</label>
                    <select id="searchMode" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="semantic">üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π</option>
                        <option value="keyword">üî§ –ü–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º</option>
                        <option value="fuzzy">üîç –ù–µ—á–µ—Ç–∫–∏–π –ø–æ–∏—Å–∫</option>
                        <option value="boolean">‚ö° –õ–æ–≥–∏—á–µ—Å–∫–∏–π</option>
                    </select>
                </div>
                <div class="flex items-end">
                    <button onclick="performCorpusSearch()" class="fractal-button bg-blue-500 hover:bg-blue-600 focus:ring-blue-300 w-full">
                        üîç –ü–æ–∏—Å–∫
                    </button>
                </div>
            </div>

            <!-- Archive List -->
            <div id="archivesList" class="space-y-4 max-h-96 overflow-y-auto">
                <div class="text-center py-12 text-gray-500">
                    <div class="text-6xl mb-6">üì¶</div>
                    <h3 class="text-xl font-semibold mb-2">–ê—Ä—Ö–∏–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                    <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∞—Ä—Ö–∏–≤, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</p>
                </div>
            </div>
        </div>

        <!-- Tabs for Advanced Features -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <div class="border-b border-gray-200 mb-6">
                <nav class="flex space-x-8">
                    <button class="tab-button active" data-tab="thesaurus" onclick="switchTab('thesaurus')">
                        üìö –¢–µ–∑–∞—É—Ä—É—Å
                    </button>
                    <button class="tab-button" data-tab="encyclopedia" onclick="switchTab('encyclopedia')">
                        üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è
                    </button>
                    <button class="tab-button" data-tab="semantic" onclick="switchTab('semantic')">
                        üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
                    </button>
                    <button class="tab-button" data-tab="dictionary" onclick="switchTab('dictionary')">
                        üåê –°–ª–æ–≤–∞—Ä—å
                    </button>
                </nav>
            </div>

            <!-- Thesaurus Tab -->
            <div id="thesaurusTab" class="tab-content">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-800">üìö –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ–∑–∞—É—Ä—É—Å</h3>
                    <div class="flex space-x-2">
                        <button onclick="buildIntegratedThesaurus()" class="fractal-button bg-teal-500 hover:bg-teal-600 focus:ring-teal-300">
                            üèóÔ∏è –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–∑–∞—É—Ä—É—Å
                        </button>
                        <button onclick="exportThesaurus()" class="fractal-button bg-green-500 hover:bg-green-600 focus:ring-green-300">
                            üíæ –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                    </div>
                </div>
                <div id="thesaurusList" class="space-y-4 max-h-96 overflow-y-auto">
                    <!-- Thesaurus entries will be loaded here -->
                </div>
            </div>

            <!-- Encyclopedia Tab -->
            <div id="encyclopediaTab" class="tab-content hidden">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-800">üî¨ –ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è</h3>
                    <div class="flex space-x-2">
                        <button onclick="generateEncyclopedia()" class="fractal-button bg-purple-500 hover:bg-purple-600 focus:ring-purple-300">
                            üåê –°–æ–∑–¥–∞—Ç—å —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—é
                        </button>
                        <button onclick="extractConcepts()" class="fractal-button bg-indigo-500 hover:bg-indigo-600 focus:ring-indigo-300">
                            üî¨ –ò–∑–≤–ª–µ—á—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
                        </button>
                    </div>
                </div>
                <div id="encyclopediaList" class="space-y-4 max-h-96 overflow-y-auto">
                    <!-- Encyclopedia entries will be loaded here -->
                </div>
            </div>

            <!-- Semantic Analysis Tab -->
            <div id="semanticTab" class="tab-content hidden">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold text-gray-800">üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h3>
                    <div class="flex space-x-2">
                        <button onclick="generateSemanticMap()" class="fractal-button bg-blue-500 hover:bg-blue-600 focus:ring-blue-300">
                            üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞
                        </button>
                        <button onclick="performEthicalAudit()" class="fractal-button bg-red-500 hover:bg-red-600 focus:ring-red-300">
                            ‚öñÔ∏è –≠—Ç–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç
                        </button>
                    </div>
                </div>
                <div id="semanticAnalysis" class="space-y-6">
                    <!-- Semantic analysis content will be loaded here -->
                </div>
            </div>

            <!-- Dictionary Tab -->
            <div id="dictionaryTab" class="tab-content hidden">
                <div class="mb-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">üåê –£–∑–±–µ–∫—Å–∫–æ-–Ω–µ–º–µ—Ü–∫–∏–π —Å–ª–æ–≤–∞—Ä—å —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="dictionarySearch" class="block text-sm font-medium text-gray-700 mb-2">–ü–æ–∏—Å–∫ —Å–ª–æ–≤–∞:</label>
                            <input 
                                type="text" 
                                id="dictionarySearch" 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –Ω–∞ —É–∑–±–µ–∫—Å–∫–æ–º..."
                                onkeyup="if(event.key === 'Enter') searchDictionary()">
                        </div>
                        <div class="flex items-end">
                            <button onclick="searchDictionary()" class="fractal-button bg-blue-500 hover:bg-blue-600 focus:ring-blue-300 w-full">
                                üîç –ü–æ–∏—Å–∫
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="dictionaryResults" class="space-y-4">
                    <div class="text-center py-8 text-gray-500">
                        <div class="text-4xl mb-4">üìö</div>
                        <p>–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal for Archive Details -->
    <div id="contentModal" class="modal hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">–î–µ—Ç–∞–ª–∏ –∞—Ä—Ö–∏–≤–∞</h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            <div id="modalContent">
                <!-- Modal content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white p-6 mt-12">
        <div class="container mx-auto text-center">
            <div class="mb-4">
                <h3 class="text-lg font-semibold mb-2">üåç Terra Archive Manager 2.0 Ultimate</h3>
                <p class="text-gray-300">–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞–Ω–∏–π —Å –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å—é</p>
            </div>
            <div class="grid grid-cols-4 gap-8 text-sm">
                <div>
                    <h4 class="font-semibold text-blue-300 mb-2">üß¨ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h4>
                    <ul class="text-gray-400 space-y-1">
                        <li>–§—Ä–∞–∫—Ç–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ L0-L7</li>
                        <li>–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</li>
                        <li>–≠—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è</li>
                        <li>100% –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-green-300 mb-2">üåê –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å</h4>
                    <ul class="text-gray-400 space-y-1">
                        <li>üá∫üáø O'zbek tili</li>
                        <li>üá∑üá∫ –†—É—Å—Å–∫–∏–π —è–∑—ã–∫</li>
                        <li>üá∫üá∏ English</li>
                        <li>üá©üá™ Deutsch</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-purple-300 mb-2">‚ôø –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å</h4>
                    <ul class="text-gray-400 space-y-1">
                        <li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Braille</li>
                        <li>–ñ–µ—Å—Ç–æ–≤—ã–π —è–∑—ã–∫</li>
                        <li>–ü–∏–∫—Ç–æ–≥—Ä–∞–º–º—ã</li>
                        <li>–í—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-orange-300 mb-2">‚ö° –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</h4>
                    <ul class="text-gray-400 space-y-1">
                        <li>Pentium I –∏ –≤—ã—à–µ</li>
                        <li>–í—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã</li>
                        <li>Vendor Independence</li>
                        <li>Fallback —Ä–µ–∂–∏–º—ã</li>
                    </ul>
                </div>
            </div>
            <div class="mt-6 pt-6 border-t border-gray-700">
                <p class="text-gray-400">
                    ¬© 2024 –ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á ‚Ä¢ 
                    DID: aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890 ‚Ä¢ 
                    Terra Ultimate v2.0
                </p>
            </div>
        </div>
    </footer>

    <script>
        // =========================================================================
        // TERRA ARCHIVE MANAGER 2.0 ULTIMATE - –ü–û–õ–ù–´–ô JAVASCRIPT –ö–û–î
        // –ê–≤—Ç–æ—Ä: –ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á
        // DID: aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890
        // –§—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ L0-L7 —Å –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å—é
        // =========================================================================

        // ===== –ë–ê–ó–û–í–´–ô L0 –°–ï–ú–ê–ù–¢–ò–ß–ï–°–ö–ò–ô –Ø–î–†–û =====
        
        function L0SemanticKernel() {
            this.version = "2.0.0-L0";
            this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
            this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
            
            // –ü—Ä–æ—Å—Ç–µ–π—à–∏–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è L0
            this.basicKeywords = {
                '–∞—Ä—Ö–∏–≤': ['—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å', '–¥–∞–Ω–Ω—ã–µ', '—Ñ–∞–π–ª', '–¥–æ–∫—É–º–µ–Ω—Ç'],
                '–ø–æ–∏—Å–∫': ['–Ω–∞–π—Ç–∏', '–∏—Å–∫–∞—Ç—å', '–∑–∞–ø—Ä–æ—Å', '—Ä–µ–∑—É–ª—å—Ç–∞—Ç'],
                '–∞–Ω–∞–ª–∏–∑': ['–∏–∑—É—á–∏—Ç—å', '–ø—Ä–æ–≤–µ—Ä–∏—Ç—å', '–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å', '–ø–æ–Ω—è—Ç—å'],
                '–ø–æ–º–æ—â—å': ['—Å–ø—Ä–∞–≤–∫–∞', '–ø–æ–¥–¥–µ—Ä–∂–∫–∞', '–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è', '—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ']
            };
            
            // –ë–∞–∑–æ–≤—ã–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            this.intentPatterns = {
                'CREATE_ARCHIVE': ['—Å–æ–∑–¥–∞—Ç—å', '—Å–¥–µ–ª–∞—Ç—å', '–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å', '—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å'],
                'SEARCH_ARCHIVE': ['–Ω–∞–π—Ç–∏', '–ø–æ–∏—Å–∫', '–∏—Å–∫–∞—Ç—å', '–≥–¥–µ'],
                'ANALYZE_TEXT': ['–∞–Ω–∞–ª–∏–∑', '–∏–∑—É—á–∏—Ç—å', '–ø—Ä–æ–≤–µ—Ä–∏—Ç—å', '–ø–æ–Ω—è—Ç—å'],
                'GET_HELP': ['–ø–æ–º–æ—â—å', '—Å–ø—Ä–∞–≤–∫–∞', '–∫–∞–∫', '—á—Ç–æ']
            };
        }
        
        L0SemanticKernel.prototype.extractKeywords = function(text) {
            if (!text) return [];
            
            var words = text.toLowerCase().split(/\s+/);
            var keywords = [];
            
            for (var i = 0; i < words.length; i++) {
                var word = words[i].replace(/[^\w\u0400-\u04FF\u0600-\u06FF]/g, '');
                if (word.length > 2) {
                    keywords.push(word);
                }
            }
            
            // –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
            var unique = [];
            for (var j = 0; j < keywords.length; j++) {
                if (unique.indexOf(keywords[j]) === -1) {
                    unique.push(keywords[j]);
                }
            }
            
            return unique.slice(0, 10); // –ú–∞–∫—Å–∏–º—É–º 10 –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        };
        
        L0SemanticKernel.prototype.simpleIntentAnalysis = function(text) {
            if (!text) return 'UNKNOWN';
            
            var lowerText = text.toLowerCase();
            var maxScore = 0;
            var detectedIntent = 'UNKNOWN';
            
            for (var intent in this.intentPatterns) {
                var patterns = this.intentPatterns[intent];
                var score = 0;
                
                for (var i = 0; i < patterns.length; i++) {
                    if (lowerText.indexOf(patterns[i]) !== -1) {
                        score++;
                    }
                }
                
                if (score > maxScore) {
                    maxScore = score;
                    detectedIntent = intent;
                }
            }
            
            return detectedIntent;
        };
        
        L0SemanticKernel.prototype.processRequest = function(request, requesterDID) {
            var keywords = this.extractKeywords(request);
            var intent = this.simpleIntentAnalysis(request);
            
            var response = {
                processedAt: new Date().toISOString(),
                requesterDID: requesterDID,
                detectedIntent: intent,
                extractedKeywords: keywords,
                confidence: keywords.length > 0 ? 0.7 : 0.3,
                suggestedAction: this.getSuggestedAction(intent),
                ethicalCheck: this.basicEthicalCheck(request)
            };
            
            return response;
        };
        
        L0SemanticKernel.prototype.getSuggestedAction = function(intent) {
            var actions = {
                'CREATE_ARCHIVE': '–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞—Ä—Ö–∏–≤ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏',
                'SEARCH_ARCHIVE': '–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–∏—Å–∫ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞—Ä—Ö–∏–≤–∞—Ö',
                'ANALYZE_TEXT': '–ü—Ä–æ–≤–µ—Å—Ç–∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞',
                'GET_HELP': '–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é',
                'UNKNOWN': '–£—Ç–æ—á–Ω–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è'
            };
            
            return actions[intent] || actions['UNKNOWN'];
        };
        
        L0SemanticKernel.prototype.basicEthicalCheck = function(text) {
            // –ü—Ä–æ—Å—Ç–µ–π—à–∞—è —ç—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –¥–µ—Ç—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            var harmfulPatterns = ['–Ω–∞—Å–∏–ª–∏–µ', 'violence', '–∑—û—Ä–∞–≤–æ–Ω–ª–∏–∫'];
            var lowerText = text.toLowerCase();
            
            for (var i = 0; i < harmfulPatterns.length; i++) {
                if (lowerText.indexOf(harmfulPatterns[i]) !== -1) {
                    return {
                        safe: false,
                        reason: '–û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤—Ä–µ–¥–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç'
                    };
                }
            }
            
            return { safe: true, reason: '–ö–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑–æ–ø–∞—Å–µ–Ω' };
        };

        // ===== –û–§–§–õ–ê–ô–ù –°–ï–ú–ê–ù–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó–ê–¢–û–† L1+ =====
        
        function OfflineSemanticAnalyzer() {
            this.version = "2.0.0-L1+";
            this.initialized = false;
            
            // –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
            this.embeddedThesaurus = {
                '–∞—Ä—Ö–∏–≤': ['—Ö—Ä–∞–Ω–∏–ª–∏—â–µ', '—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π', '–±–∞–∑–∞_–¥–∞–Ω–Ω—ã—Ö', '–∫–æ–ª–ª–µ–∫—Ü–∏—è'],
                '–¥–æ–∫—É–º–µ–Ω—Ç': ['—Ñ–∞–π–ª', '—Ç–µ–∫—Å—Ç', '–∑–∞–ø–∏—Å—å', '–º–∞—Ç–µ—Ä–∏–∞–ª'],
                '–ø–æ–∏—Å–∫': ['–ø–æ–∏—Å–∫', '–∑–∞–ø—Ä–æ—Å', '–ø–æ–∏—Å–∫', '–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ'],
                '–∞–Ω–∞–ª–∏–∑': ['–∏–∑—É—á–µ–Ω–∏–µ', '–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ', '—Ä–∞–∑–±–æ—Ä', '—ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞']
            };
            
            // –ü—Ä–æ—Å—Ç–∞—è –æ–Ω—Ç–æ–ª–æ–≥–∏—è –ø—Ä–µ–¥–º–µ—Ç–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π
            this.domainOntology = {
                '–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞': {
                    '–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏': ['–∞–ª–≥–æ—Ä–∏—Ç–º—ã', '—Å—Ç—Ä—É–∫—Ç—É—Ä—ã_–¥–∞–Ω–Ω—ã—Ö', '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ'],
                    '—Ç–µ—Ä–º–∏–Ω—ã': ['–∫–æ–¥', '—Ñ—É–Ω–∫—Ü–∏—è', '–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è', '—Ü–∏–∫–ª']
                },
                '–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞': {
                    '–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏': ['–∞–ª–≥–µ–±—Ä–∞', '–≥–µ–æ–º–µ—Ç—Ä–∏—è', '–∞–Ω–∞–ª–∏–∑'],
                    '—Ç–µ—Ä–º–∏–Ω—ã': ['—Ñ–æ—Ä–º—É–ª–∞', '—Ç–µ–æ—Ä–µ–º–∞', '–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ', '–º–Ω–æ–∂–µ—Å—Ç–≤–æ']
                }
            };
            
            // –ë–∞–∑–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π —Å —á–∞—Å—Ç–æ—Ç–∞–º–∏
            this.conceptsDatabase = {
                '–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ': { frequency: 100, related: ['—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ', '—Ö—Ä–∞–Ω–µ–Ω–∏–µ'] },
                '—Å–µ–º–∞–Ω—Ç–∏–∫–∞': { frequency: 80, related: ['–∑–Ω–∞—á–µ–Ω–∏–µ', '—Å–º—ã—Å–ª'] },
                '—ç—Ç–∏–∫–∞': { frequency: 60, related: ['–º–æ—Ä–∞–ª—å', '—Ü–µ–Ω–Ω–æ—Å—Ç–∏'] }
            };
        }
        
        OfflineSemanticAnalyzer.prototype.initialize = function() {
            console.log("üß† –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ñ—Ñ–ª–∞–π–Ω —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞...");
            this.initialized = true;
            return true;
        };
        
        OfflineSemanticAnalyzer.prototype.analyzeText = function(text) {
            if (!this.initialized) {
                this.initialize();
            }
            
            var startTime = Date.now();
            
            var analysis = {
                processingTime: 0,
                wordCount: text.split(/\s+/).length,
                keywords: this.extractAdvancedKeywords(text),
                concepts: this.extractConcepts(text),
                domains: this.identifyDomains(text),
                sentiment: this.simpleSentimentAnalysis(text),
                readabilityScore: this.calculateReadability(text),
                summary: this.generateSummary(text)
            };
            
            analysis.processingTime = Date.now() - startTime;
            return analysis;
        };
        
        OfflineSemanticAnalyzer.prototype.extractAdvancedKeywords = function(text) {
            var words = text.toLowerCase().match(/[\w\u0400-\u04FF\u0600-\u06FF]+/g) || [];
            var wordFreq = {};
            
            // –ü–æ–¥—Å—á–µ—Ç —á–∞—Å—Ç–æ—Ç
            for (var i = 0; i < words.length; i++) {
                var word = words[i];
                if (word.length > 2) {
                    wordFreq[word] = (wordFreq[word] || 0) + 1;
                }
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–µ
            var sortedWords = [];
            for (var word in wordFreq) {
                sortedWords.push({ word: word, frequency: wordFreq[word] });
            }
            
            sortedWords.sort(function(a, b) { return b.frequency - a.frequency; });
            
            return sortedWords.slice(0, 15);
        };
        
        OfflineSemanticAnalyzer.prototype.extractConcepts = function(text) {
            var concepts = [];
            var lowerText = text.toLowerCase();
            
            for (var concept in this.conceptsDatabase) {
                if (lowerText.indexOf(concept) !== -1) {
                    var conceptData = this.conceptsDatabase[concept];
                    var relevance = this.calculateConceptRelevance(concept, text);
                    
                    concepts.push({
                        concept: concept,
                        relevance: relevance,
                        frequency: conceptData.frequency,
                        matches: this.findConceptMatches(concept, text)
                    });
                }
            }
            
            return concepts.sort(function(a, b) { return b.relevance - a.relevance; });
        };
        
        OfflineSemanticAnalyzer.prototype.identifyDomains = function(text) {
            var domains = [];
            var lowerText = text.toLowerCase();
            
            for (var domain in this.domainOntology) {
                var domainData = this.domainOntology[domain];
                var confidence = 0;
                var matchedTerms = [];
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Ä–º–∏–Ω–æ–≤ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
                for (var i = 0; i < domainData.—Ç–µ—Ä–º–∏–Ω—ã.length; i++) {
                    var term = domainData.—Ç–µ—Ä–º–∏–Ω—ã[i];
                    if (lowerText.indexOf(term) !== -1) {
                        confidence += 0.3;
                        matchedTerms.push(term);
                    }
                }
                
                if (confidence > 0) {
                    domains.push({
                        domain: domain,
                        confidence: Math.min(confidence, 1.0),
                        matchedTerms: matchedTerms
                    });
                }
            }
            
            return domains.sort(function(a, b) { return b.confidence - a.confidence; });
        };
        
        OfflineSemanticAnalyzer.prototype.simpleSentimentAnalysis = function(text) {
            var positiveWords = ['—Ö–æ—Ä–æ—à–æ', '–æ—Ç–ª–∏—á–Ω–æ', '–ø—Ä–µ–∫—Ä–∞—Å–Ω–æ', '–∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ', 'great', 'excellent'];
            var negativeWords = ['–ø–ª–æ—Ö–æ', '—É–∂–∞—Å–Ω–æ', '–ø–ª–æ—Ö–æ–π', 'terrible', 'bad', 'awful'];
            
            var lowerText = text.toLowerCase();
            var positiveScore = 0;
            var negativeScore = 0;
            
            for (var i = 0; i < positiveWords.length; i++) {
                if (lowerText.indexOf(positiveWords[i]) !== -1) positiveScore++;
            }
            
            for (var j = 0; j < negativeWords.length; j++) {
                if (lowerText.indexOf(negativeWords[j]) !== -1) negativeScore++;
            }
            
            var totalScore = positiveScore - negativeScore;
            var sentiment = 'neutral';
            
            if (totalScore > 0) sentiment = 'positive';
            else if (totalScore < 0) sentiment = 'negative';
            
            return {
                sentiment: sentiment,
                positiveScore: positiveScore,
                negativeScore: negativeScore,
                confidence: Math.min((Math.abs(totalScore) / Math.max(1, text.split(' ').length)) * 10, 1)
            };
        };
        
        OfflineSemanticAnalyzer.prototype.calculateReadability = function(text) {
            var sentences = text.split(/[.!?]+/).length - 1;
            var words = text.split(/\s+/).length;
            var avgWordsPerSentence = sentences > 0 ? words / sentences : words;
            
            // –ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º—É–ª–∞ —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
            var readabilityScore = Math.max(0, Math.min(100, 100 - (avgWordsPerSentence * 2)));
            
            return {
                score: Math.round(readabilityScore),
                level: readabilityScore > 80 ? '–õ–µ–≥–∫–∏–π' : readabilityScore > 60 ? '–°—Ä–µ–¥–Ω–∏–π' : '–°–ª–æ–∂–Ω—ã–π',
                avgWordsPerSentence: Math.round(avgWordsPerSentence)
            };
        };
        
        OfflineSemanticAnalyzer.prototype.generateSummary = function(text) {
            var sentences = text.split(/[.!?]+/).filter(function(s) { return s.trim().length > 0; });
            if (sentences.length <= 2) return text;
            
            // –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π –∏ –Ω–∞–∏–±–æ–ª–µ–µ "–≤–∞–∂–Ω–æ–π" –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
            var firstSentence = sentences[0].trim();
            var longestSentence = sentences.reduce(function(a, b) {
                return a.length > b.length ? a : b;
            }).trim();
            
            if (firstSentence === longestSentence) {
                return firstSentence + '.';
            }
            
            return firstSentence + '. ' + longestSentence + '.';
        };
        
        OfflineSemanticAnalyzer.prototype.calculateConceptRelevance = function(concept, text) {
            var occurrences = (text.toLowerCase().match(new RegExp(concept, 'g')) || []).length;
            var textLength = text.split(/\s+/).length;
            return Math.min(1.0, (occurrences / textLength) * 100);
        };
        
        OfflineSemanticAnalyzer.prototype.findConceptMatches = function(concept, text) {
            var matches = [];
            var regex = new RegExp('\\b' + concept + '\\w*', 'gi');
            var match;
            
            while ((match = regex.exec(text)) !== null && matches.length < 3) {
                matches.push(match[0]);
            }
            
            return matches;
        };
        
        // ===== –≠–¢–ò–ß–ï–°–ö–ò–ô –°–õ–û–ô –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò =====
        
        function TerraEthicalLayer() {
            this.version = "7.0.0-ULTIMATE";
            this.childSafetyEnabled = true;
            this.detoxificationEnabled = true;
            
            // –ö–ª—é—á–µ–≤—ã–µ —ç—Ç–∏—á–µ—Å–∫–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏
            this.coreValues = {
                '–¥–µ—Ç—Å–∫–∞—è_–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å': {
                    priority: 1,
                    description: '–ó–∞—â–∏—Ç–∞ –¥–µ—Ç–µ–π –æ—Ç –≤—Ä–µ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞'
                },
                '–∏–Ω–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å': {
                    priority: 2,
                    description: '–†–∞–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è –≤—Å–µ—Ö –ª—é–¥–µ–π'
                },
                '–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å': {
                    priority: 3,
                    description: '–ü—Ä–∞–≤–¥–∏–≤–∞—è –∏ —Ç–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'
                },
                '–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å': {
                    priority: 4,
                    description: '–ó–∞—â–∏—Ç–∞ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö'
                }
            };
            
            // –î–µ—Ç–æ–∫—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã
            this.toxicityFilters = [
                {
                    name: 'child_protection',
                    patterns: ['–Ω–∞—Å–∏–ª–∏–µ', 'violence', '–∑—û—Ä–∞–≤–æ–Ω–ª–∏–∫', 'harm'],
                    severity: 'high',
                    action: 'block'
                },
                {
                    name: 'hate_speech',
                    patterns: ['–Ω–µ–Ω–∞–≤–∏—Å—Ç—å', 'hate', '–Ω–∞—Ñ—Ä–∞—Ç'],
                    severity: 'high',
                    action: 'block'
                },
                {
                    name: 'misinformation',
                    patterns: ['—Ñ–µ–π–∫', 'fake', '—ë–ª“ì–æ–Ω'],
                    severity: 'medium',
                    action: 'warn'
                }
            ];
            
            this.statistics = {
                totalChecks: 0,
                blockedContent: 0,
                warningsIssued: 0,
                enhancedContent: 0
            };
        }
        
        TerraEthicalLayer.prototype.validateContent = function(content) {
            this.statistics.totalChecks++;
            
            var result = {
                passed: true,
                violations: [],
                warnings: [],
                enhancements: [],
                safetyScore: 100
            };
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å
            for (var i = 0; i < this.toxicityFilters.length; i++) {
                var filter = this.toxicityFilters[i];
                var violation = this.checkFilter(content, filter);
                
                if (violation) {
                    if (filter.action === 'block') {
                        result.passed = false;
                        result.violations.push(violation);
                        result.safetyScore -= 30;
                        this.statistics.blockedContent++;
                    } else if (filter.action === 'warn') {
                        result.warnings.push(violation);
                        result.safetyScore -= 10;
                        this.statistics.warningsIssued++;
                    }
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã
            var enhancements = this.identifyEnhancements(content);
            result.enhancements = enhancements;
            this.statistics.enhancedContent += enhancements.length;
            
            result.safetyScore = Math.max(0, result.safetyScore);
            
            return result;
        };
        
        TerraEthicalLayer.prototype.checkFilter = function(content, filter) {
            var lowerContent = content.toLowerCase();
            
            for (var i = 0; i < filter.patterns.length; i++) {
                var pattern = filter.patterns[i];
                if (lowerContent.indexOf(pattern) !== -1) {
                    return {
                        filterName: filter.name,
                        severity: filter.severity,
                        pattern: pattern,
                        message: '–û–±–Ω–∞—Ä—É–∂–µ–Ω –∫–æ–Ω—Ç–µ–Ω—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ' + filter.name
                    };
                }
            }
            
            return null;
        };
        
        TerraEthicalLayer.prototype.identifyEnhancements = function(content) {
            var enhancements = [];
            var lowerContent = content.toLowerCase();
            
            var positivePatterns = [
                { pattern: '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', message: '–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç' },
                { pattern: '–ø–æ–º–æ—â—å', message: '–ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è' },
                { pattern: '–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', message: '–ö–æ–Ω—Ç–µ–Ω—Ç –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏' },
                { pattern: '–∏–Ω–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å', message: '–ò–Ω–∫–ª—é–∑–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥' }
            ];
            
            for (var i = 0; i < positivePatterns.length; i++) {
                var positive = positivePatterns[i];
                if (lowerContent.indexOf(positive.pattern) !== -1) {
                    enhancements.push({
                        type: 'positive_content',
                        message: positive.message
                    });
                }
            }
            
            return enhancements;
        };
        
        TerraEthicalLayer.prototype.generateEthicalReport = function() {
            return {
                version: this.version,
                statistics: this.statistics,
                filtersActive: {
                    childSafety: this.toxicityFilters.filter(function(f) { return f.name.includes('child'); }).length,
                    detoxification: this.toxicityFilters.length
                },
                coreValues: this.coreValues,
                recommendations: this.generateRecommendations()
            };
        };
        
        TerraEthicalLayer.prototype.generateRecommendations = function() {
            var recommendations = [];
            
            if (this.statistics.blockedContent > 0) {
                recommendations.push('–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —É—Å–∏–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ');
            }
            
            if (this.statistics.enhancedContent < this.statistics.totalChecks * 0.1) {
                recommendations.push('–£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ–ª—é –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞');
            }
            
            return recommendations;
        };
        
        // ===== –ê–†–•–ò–í–ù–´–ô –ú–ï–ù–ï–î–ñ–ï–† =====
        
        function TerraArchiveManager() {
            this.version = "2.0.0-ULTIMATE";
            this.archives = [];
            this.thesaurus = [];
            this.encyclopedia = [];
            this.maxLevel = 7;
            
            // –õ–∏–º–∏—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º
            this.storageLimits = {
                0: 1024 * 1024,      // 1MB –¥–ª—è L0
                1: 10 * 1024 * 1024, // 10MB –¥–ª—è L1
                2: 50 * 1024 * 1024, // 50MB –¥–ª—è L2
                3: 100 * 1024 * 1024, // 100MB –¥–ª—è L3
                4: 500 * 1024 * 1024, // 500MB –¥–ª—è L4
                5: 1024 * 1024 * 1024, // 1GB –¥–ª—è L5
                6: 5 * 1024 * 1024 * 1024, // 5GB –¥–ª—è L6
                7: -1 // –ë–µ–∑ –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è L7
            };
            
            this.loadExistingData();
        }
        
        TerraArchiveManager.prototype.loadExistingData = function() {
            try {
                var stored = localStorage.getItem('terra_archives_ultimate');
                if (stored) {
                    this.archives = JSON.parse(stored);
                }
                
                var storedThesaurus = localStorage.getItem('terra_thesaurus_ultimate');
                if (storedThesaurus) {
                    this.thesaurus = JSON.parse(storedThesaurus);
                }
                
                var storedEncyclopedia = localStorage.getItem('terra_encyclopedia_ultimate');
                if (storedEncyclopedia) {
                    this.encyclopedia = JSON.parse(storedEncyclopedia);
                }
            } catch (error) {
                console.warn("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:", error);
                this.archives = [];
                this.thesaurus = [];
                this.encyclopedia = [];
            }
        };
        
        TerraArchiveManager.prototype.saveData = function() {
            try {
                localStorage.setItem('terra_archives_ultimate', JSON.stringify(this.archives));
                localStorage.setItem('terra_thesaurus_ultimate', JSON.stringify(this.thesaurus));
                localStorage.setItem('terra_encyclopedia_ultimate', JSON.stringify(this.encyclopedia));
                return true;
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:", error);
                return false;
            }
        };
        
        TerraArchiveManager.prototype.createArchive = function(data, level, requesterDID) {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ —É—Ä–æ–≤–Ω—è
            var currentSize = this.getCurrentStorageSize();
            var levelLimit = this.storageLimits[level];
            var estimatedSize = JSON.stringify(data).length;
            
            if (levelLimit > 0 && currentSize + estimatedSize > levelLimit) {
                return {
                    success: false,
                    error: '–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è —É—Ä–æ–≤–Ω—è L' + level,
                    currentSize: currentSize,
                    limit: levelLimit
                };
            }
            
            var archive = {
                id: this.generateArchiveId(),
                timestamp: new Date().toISOString(),
                level: level,
                requesterDID: requesterDID,
                data: data,
                size: estimatedSize,
                checksum: this.calculateChecksum(data),
                metadata: {
                    created: new Date().toISOString(),
                    version: this.version,
                    author: "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á"
                }
            };
            
            this.archives.push(archive);
            this.saveData();
            
            return {
                success: true,
                archiveId: archive.id,
                level: level,
                size: estimatedSize
            };
        };
        
        TerraArchiveManager.prototype.searchArchives = function(query, options) {
            options = options || {};
            var mode = options.mode || 'semantic';
            var results = [];
            var startTime = Date.now();
            
            for (var i = 0; i < this.archives.length; i++) {
                var archive = this.archives[i];
                var relevance = this.calculateRelevance(query, archive, mode);
                
                if (relevance > 0.1) { // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
                    results.push({
                        item: archive,
                        relevance: relevance,
                        matchType: mode
                    });
                }
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
            results.sort(function(a, b) { return b.relevance - a.relevance; });
            
            return {
                results: results,
                totalFound: results.length,
                processingTime: Date.now() - startTime,
                searchMethod: mode
            };
        };
        
        TerraArchiveManager.prototype.calculateRelevance = function(query, archive, mode) {
            var lowerQuery = query.toLowerCase();
            var archiveText = JSON.stringify(archive.data).toLowerCase();
            
            if (mode === 'keyword') {
                // –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
                var queryWords = lowerQuery.split(/\s+/);
                var matches = 0;
                
                for (var i = 0; i < queryWords.length; i++) {
                    if (archiveText.indexOf(queryWords[i]) !== -1) {
                        matches++;
                    }
                }
                
                return matches / queryWords.length;
            } else if (mode === 'semantic') {
                // –ü—Ä–æ—Å—Ç–æ–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
                var semanticScore = 0;
                
                // –ü—Ä—è–º—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                if (archiveText.indexOf(lowerQuery) !== -1) {
                    semanticScore += 0.8;
                }
                
                // –ß–∞—Å—Ç–∏—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                var queryWords = lowerQuery.split(/\s+/);
                for (var j = 0; j < queryWords.length; j++) {
                    if (archiveText.indexOf(queryWords[j]) !== -1) {
                        semanticScore += 0.2 / queryWords.length;
                    }
                }
                
                return Math.min(1.0, semanticScore);
            }
            
            return 0;
        };
        
        TerraArchiveManager.prototype.generateArchiveId = function() {
            return 'terra_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        };
        
        TerraArchiveManager.prototype.calculateChecksum = function(data) {
            // –ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞
            var str = JSON.stringify(data);
            var hash = 0;
            
            for (var i = 0; i < str.length; i++) {
                var char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // 32-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ
            }
            
            return hash.toString(16);
        };
        
        TerraArchiveManager.prototype.getCurrentStorageSize = function() {
            var totalSize = 0;
            
            for (var i = 0; i < this.archives.length; i++) {
                totalSize += this.archives[i].size || 0;
            }
            
            return totalSize;
        };
        
        TerraArchiveManager.prototype.getStorageStats = function() {
            return {
                totalArchives: this.archives.length,
                totalSize: this.getCurrentStorageSize(),
                thesaurusEntries: this.thesaurus.length,
                encyclopediaEntries: this.encyclopedia.length,
                oldestArchive: this.archives.length > 0 ? this.archives[0].timestamp : null,
                newestArchive: this.archives.length > 0 ? this.archives[this.archives.length - 1].timestamp : null
            };
        };
        
        // ===== –ò–ù–¢–ï–ì–†–ê–¶–ò–û–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê TERRA =====
        
        function TerraSemanticIntegration() {
            this.version = "2.0.0-ULTIMATE";
            this.author = "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á";
            this.did = "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890";
            this.currentLevel = 0;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
            this.l0Kernel = new L0SemanticKernel();
            this.ethicalLayer = new TerraEthicalLayer();
            this.archiveManager = new TerraArchiveManager();
            this.offlineAnalyzer = null; // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è L1+
            
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –±—Ä–∞—É–∑–µ—Ä–∞
            this.browserCapabilities = this.detectBrowserCapabilities();
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
            this.integrationStats = this.loadIntegrationStats();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
            this.initializeComponents();
        }
        
        TerraSemanticIntegration.prototype.detectBrowserCapabilities = function() {
            var caps = {
                // –ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                es3Support: true, // –í—Å–µ–≥–¥–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
                es5Support: !!(Array.prototype.forEach && Object.keys),
                es6Support: !!(Promise && Array.from && Object.assign),
                
                // –•—Ä–∞–Ω–∏–ª–∏—â–µ
                localStorageSupport: !!(window.localStorage),
                indexedDBSupport: !!(window.indexedDB),
                
                // –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                webWorkersSupport: !!(window.Worker),
                serviceWorkerSupport: !!('serviceWorker' in navigator),
                webAssemblySupport: !!(window.WebAssembly),
                
                // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞
                browserFamily: this.getBrowserFamily(),
                isOldBrowser: this.isOldBrowser(),
                
                // –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                estimatedRAM: this.estimateRAM(),
                processingPower: this.estimateProcessingPower(),
                screenSize: {
                    width: screen.width || 1024,
                    height: screen.height || 768
                }
            };
            
            return caps;
        };
        
        TerraSemanticIntegration.prototype.getBrowserFamily = function() {
            var ua = navigator.userAgent;
            
            if (ua.indexOf('Firefox') !== -1) return 'Firefox';
            if (ua.indexOf('Chrome') !== -1) return 'Chrome';
            if (ua.indexOf('Safari') !== -1) return 'Safari';
            if (ua.indexOf('Edge') !== -1) return 'Edge';
            if (ua.indexOf('MSIE') !== -1) return 'IE';
            
            return 'Unknown';
        };
        
        TerraSemanticIntegration.prototype.isOldBrowser = function() {
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
            var es5Support = !!(Array.prototype.forEach && Object.keys);
            return !es5Support || 
                   navigator.userAgent.indexOf('MSIE') !== -1 ||
                   navigator.userAgent.indexOf('Trident') !== -1;
        };
        
        TerraSemanticIntegration.prototype.estimateRAM = function() {
            // –û—Ü–µ–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏
            if (navigator.deviceMemory) {
                return navigator.deviceMemory * 1024; // GB to MB
            }
            
            // –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞
            var estimate = 2048; // 2GB –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            
            if (screen.width >= 1920) estimate = 8192; // 8GB –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
            else if (screen.width >= 1366) estimate = 4096; // 4GB –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö
            else if (screen.width < 1024) estimate = 1024;  // 1GB –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
            
            return estimate;
        };
        
        TerraSemanticIntegration.prototype.estimateProcessingPower = function() {
            // –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            var start = Date.now();
            var iterations = 100000;
            
            for (var i = 0; i < iterations; i++) {
                Math.sqrt(i);
            }
            
            var elapsed = Date.now() - start;
            
            if (elapsed < 10) return 'fast';
            if (elapsed < 30) return 'medium';
            return 'slow';
        };
        
        TerraSemanticIntegration.prototype.initializeComponents = function() {
            console.log("üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Terra Semantic Integration...");
            
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è
            var maxLevel = this.determineMaxLevel();
            this.currentLevel = Math.min(this.currentLevel, maxLevel);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
            if (this.currentLevel >= 1) {
                this.offlineAnalyzer = new OfflineSemanticAnalyzer();
                this.offlineAnalyzer.initialize();
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            this.loadSystemData();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            this.updateUI();
            
            console.log("‚úÖ Terra —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ L" + this.currentLevel);
        };
        
        TerraSemanticIntegration.prototype.determineMaxLevel = function() {
            var caps = this.browserCapabilities;
            
            // L0: –ë–∞–∑–æ–≤–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (–≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω)
            var maxLevel = 0;
            
            // L1: ES5 + LocalStorage + –º–∏–Ω–∏–º—É–º 512MB RAM
            if (caps.es5Support && caps.localStorageSupport && caps.estimatedRAM >= 512) {
                maxLevel = 1;
            }
            
            // L2: ES6 + IndexedDB + –º–∏–Ω–∏–º—É–º 2GB RAM
            if (caps.es6Support && caps.indexedDBSupport && caps.estimatedRAM >= 2048) {
                maxLevel = 2;
            }
            
            // L3: Web Workers + –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å + –º–∏–Ω–∏–º—É–º 4GB RAM
            if (caps.webWorkersSupport && caps.processingPower === 'fast' && caps.estimatedRAM >= 4096) {
                maxLevel = 3;
            }
            
            return maxLevel;
        };
        
        TerraSemanticIntegration.prototype.loadIntegrationStats = function() {
            try {
                var stored = localStorage.getItem('terra_integration_stats');
                if (stored) {
                    return JSON.parse(stored);
                }
            } catch (error) {
                console.warn("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:", error);
            }
            
            return {
                totalProcessed: 0,
                semanticAnalyses: 0,
                ethicalChecks: 0,
                archiveOperations: 0,
                lastActivity: null
            };
        };
        
        TerraSemanticIntegration.prototype.saveIntegrationStats = function() {
            try {
                this.integrationStats.lastActivity = new Date().toISOString();
                localStorage.setItem('terra_integration_stats', JSON.stringify(this.integrationStats));
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:", error);
            }
        };
        
        TerraSemanticIntegration.prototype.processArchiveRequest = function(request, attachments, requesterDID) {
            this.integrationStats.totalProcessed++;
            this.integrationStats.archiveOperations++;
            
            // –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞
            var analysis;
            if (this.currentLevel >= 1 && this.offlineAnalyzer) {
                analysis = this.offlineAnalyzer.analyzeText(request);
                this.integrationStats.semanticAnalyses++;
            } else {
                analysis = this.l0Kernel.processRequest(request, requesterDID);
            }
            
            // –≠—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
            var ethicalCheck = this.ethicalLayer.validateContent(request);
            this.integrationStats.ethicalChecks++;
            
            if (!ethicalCheck.passed) {
                this.saveIntegrationStats();
                return {
                    success: false,
                    error: '–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –ø—Ä–æ—à–µ–ª —ç—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É',
                    violations: ethicalCheck.violations
                };
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞
            var archiveData = {
                text: request,
                attachments: attachments || [],
                analysis: analysis,
                ethicalCheck: ethicalCheck,
                processingLevel: this.currentLevel
            };
            
            var result = this.archiveManager.createArchive(archiveData, this.currentLevel, requesterDID);
            
            this.saveIntegrationStats();
            this.updateUI();
            
            return result;
        };
        
        TerraSemanticIntegration.prototype.searchArchive = function(query, options) {
            this.integrationStats.totalProcessed++;
            
            var searchResults;
            
            if (this.currentLevel >= 1 && this.offlineAnalyzer) {
                // –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –¥–ª—è L1+
                searchResults = this.performSemanticSearch(query, options);
                this.integrationStats.semanticAnalyses++;
            } else {
                // –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –¥–ª—è L0
                searchResults = this.archiveManager.searchArchives(query, options);
            }
            
            this.saveIntegrationStats();
            return searchResults;
        };
        
        TerraSemanticIntegration.prototype.performSemanticSearch = function(query, options) {
            var startTime = Date.now();
            
            // –ê–Ω–∞–ª–∏–∑ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
            var queryAnalysis = this.offlineAnalyzer.analyzeText(query);
            var results = [];
            
            // –ü–æ–∏—Å–∫ –ø–æ –∞—Ä—Ö–∏–≤–∞–º —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º
            for (var i = 0; i < this.archiveManager.archives.length; i++) {
                var archive = this.archiveManager.archives[i];
                var archiveText = archive.data.text || '';
                
                if (archiveText) {
                    var similarity = this.calculateSemanticSimilarity(queryAnalysis, archive.data.analysis);
                    var matchedConcepts = this.findMatchedConcepts(queryAnalysis, archive.data.analysis);
                    
                    if (similarity > 0.2) {
                        results.push({
                            item: archive,
                            similarity: similarity,
                            matchedConcepts: matchedConcepts,
                            searchMethod: 'semantic'
                        });
                    }
                }
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏
            results.sort(function(a, b) { return b.similarity - a.similarity; });
            
            return {
                results: results,
                totalFound: results.length,
                processingTime: Date.now() - startTime,
                searchMethod: 'semantic_L' + this.currentLevel,
                queryAnalysis: queryAnalysis
            };
        };
        
        TerraSemanticIntegration.prototype.calculateSemanticSimilarity = function(analysis1, analysis2) {
            if (!analysis1 || !analysis2) return 0;
            
            var similarity = 0;
            var factors = 0;
            
            // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
            if (analysis1.keywords && analysis2.keywords) {
                var keywordSimilarity = this.compareKeywords(analysis1.keywords, analysis2.keywords);
                similarity += keywordSimilarity * 0.4;
                factors += 0.4;
            }
            
            // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π
            if (analysis1.concepts && analysis2.concepts) {
                var conceptSimilarity = this.compareConcepts(analysis1.concepts, analysis2.concepts);
                similarity += conceptSimilarity * 0.4;
                factors += 0.4;
            }
            
            // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π
            if (analysis1.domains && analysis2.domains) {
                var domainSimilarity = this.compareDomains(analysis1.domains, analysis2.domains);
                similarity += domainSimilarity * 0.2;
                factors += 0.2;
            }
            
            return factors > 0 ? similarity / factors : 0;
        };
        
        TerraSemanticIntegration.prototype.compareKeywords = function(keywords1, keywords2) {
            if (!keywords1.length || !keywords2.length) return 0;
            
            var matches = 0;
            var total = Math.max(keywords1.length, keywords2.length);
            
            for (var i = 0; i < keywords1.length; i++) {
                var word1 = keywords1[i].word || keywords1[i];
                
                for (var j = 0; j < keywords2.length; j++) {
                    var word2 = keywords2[j].word || keywords2[j];
                    
                    if (word1 === word2) {
                        matches++;
                        break;
                    }
                }
            }
            
            return matches / total;
        };
        
        TerraSemanticIntegration.prototype.compareConcepts = function(concepts1, concepts2) {
            if (!concepts1.length || !concepts2.length) return 0;
            
            var matches = 0;
            var total = Math.max(concepts1.length, concepts2.length);
            
            for (var i = 0; i < concepts1.length; i++) {
                var concept1 = concepts1[i].concept || concepts1[i];
                
                for (var j = 0; j < concepts2.length; j++) {
                    var concept2 = concepts2[j].concept || concepts2[j];
                    
                    if (concept1 === concept2) {
                        matches++;
                        break;
                    }
                }
            }
            
            return matches / total;
        };
        
        TerraSemanticIntegration.prototype.compareDomains = function(domains1, domains2) {
            if (!domains1.length || !domains2.length) return 0;
            
            var matches = 0;
            var total = Math.max(domains1.length, domains2.length);
            
            for (var i = 0; i < domains1.length; i++) {
                var domain1 = domains1[i].domain || domains1[i];
                
                for (var j = 0; j < domains2.length; j++) {
                    var domain2 = domains2[j].domain || domains2[j];
                    
                    if (domain1 === domain2) {
                        matches++;
                        break;
                    }
                }
            }
            
            return matches / total;
        };
        
        TerraSemanticIntegration.prototype.findMatchedConcepts = function(analysis1, analysis2) {
            var matches = [];
            
            if (!analysis1.concepts || !analysis2.concepts) return matches;
            
            for (var i = 0; i < analysis1.concepts.length && matches.length < 5; i++) {
                var concept1 = analysis1.concepts[i].concept || analysis1.concepts[i];
                
                for (var j = 0; j < analysis2.concepts.length; j++) {
                    var concept2 = analysis2.concepts[j].concept || analysis2.concepts[j];
                    
                    if (concept1 === concept2 && matches.indexOf(concept1) === -1) {
                        matches.push(concept1);
                        break;
                    }
                }
            }
            
            return matches;
        };
        
        TerraSemanticIntegration.prototype.updateUI = function() {
            this.updateSystemStatus();
            this.updateArchivesList();
            this.updateTabCounts();
        };
        
        TerraSemanticIntegration.prototype.updateSystemStatus = function() {
            var levelElement = document.getElementById('currentLevel');
            var archiveCountElement = document.getElementById('archiveCount');
            var analysisCountElement = document.getElementById('analysisCount');
            var storageUsedElement = document.getElementById('storageUsed');
            var systemLevelIndicator = document.getElementById('systemLevelIndicator');
            
            if (levelElement) levelElement.textContent = 'L' + this.currentLevel;
            if (systemLevelIndicator) systemLevelIndicator.textContent = 'üß¨ –£—Ä–æ–≤–µ–Ω—å: L' + this.currentLevel;
            if (archiveCountElement) archiveCountElement.textContent = this.archiveManager.archives.length;
            if (analysisCountElement) analysisCountElement.textContent = this.integrationStats.semanticAnalyses;
            if (storageUsedElement) storageUsedElement.textContent = this.formatFileSize(this.archiveManager.getCurrentStorageSize());
        };
        
        TerraSemanticIntegration.prototype.updateArchivesList = function() {
            var container = document.getElementById('archivesList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (this.archiveManager.archives.length === 0) {
                container.innerHTML = 
                    '<div class="text-center py-12 text-gray-500">' +
                        '<div class="text-6xl mb-6">üì¶</div>' +
                        '<h3 class="text-xl font-semibold mb-2">–ê—Ä—Ö–∏–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>' +
                        '<p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∞—Ä—Ö–∏–≤, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</p>' +
                    '</div>';
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∞—Ä—Ö–∏–≤–æ–≤
            var recentArchives = this.archiveManager.archives.slice(-10).reverse();
            
            for (var i = 0; i < recentArchives.length; i++) {
                var archive = recentArchives[i];
                var archiveElement = document.createElement('div');
                archiveElement.className = 'archive-item';
                
                archiveElement.innerHTML = 
                    '<div class="flex justify-between items-start">' +
                        '<div class="flex-1">' +
                            '<h4 class="font-semibold text-gray-800 mb-1">üì¶ –ê—Ä—Ö–∏–≤ #' + archive.id.slice(-6) + '</h4>' +
                            '<p class="text-sm text-gray-600 mb-2">' + new Date(archive.timestamp).toLocaleString() + '</p>' +
                            '<p class="text-sm text-gray-700 line-clamp-2">' + (archive.data.text || '–§–∞–π–ª–æ–≤—ã–π –∞—Ä—Ö–∏–≤').slice(0, 100) + '...</p>' +
                        '</div>' +
                        '<div class="text-right ml-4">' +
                            '<div class="text-sm text-gray-500">' + this.formatFileSize(archive.size) + '</div>' +
                            '<div class="text-xs text-purple-600 font-semibold">L' + archive.level + '</div>' +
                        '</div>' +
                    '</div>';
                
                archiveElement.onclick = (function(archive) {
                    return function() {
                        terraSystem.showArchiveDetails(archive);
                    };
                })(archive);
                
                container.appendChild(archiveElement);
            }
        };
        
        TerraSemanticIntegration.prototype.updateTabCounts = function() {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤–æ –≤–∫–ª–∞–¥–∫–∞—Ö
            var thesaurusCount = this.archiveManager.thesaurus.length;
            var encyclopediaCount = this.archiveManager.encyclopedia.length;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤–æ –≤–∫–ª–∞–¥–∫–∞—Ö —Å —Å—á–µ—Ç—á–∏–∫–∞–º–∏
            var thesaurusTab = document.querySelector('[data-tab="thesaurus"]');
            var encyclopediaTab = document.querySelector('[data-tab="encyclopedia"]');
            
            if (thesaurusTab && thesaurusCount > 0) {
                thesaurusTab.innerHTML = 'üìö –¢–µ–∑–∞—É—Ä—É—Å (' + thesaurusCount + ')';
            }
            
            if (encyclopediaTab && encyclopediaCount > 0) {
                encyclopediaTab.innerHTML = 'üî¨ –≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è (' + encyclopediaCount + ')';
            }
        };
        
        TerraSemanticIntegration.prototype.showArchiveDetails = function(archive) {
            var modal = document.getElementById('contentModal');
            var modalContent = document.getElementById('modalContent');
            
            if (!modal || !modalContent) return;
            
            var analysisInfo = '';
            if (archive.data.analysis) {
                var analysis = archive.data.analysis;
                analysisInfo = 
                    '<div class="mt-6 p-4 bg-blue-50 rounded-lg">' +
                        '<h4 class="font-semibold text-blue-800 mb-3">üß† –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h4>';
                
                if (analysis.keywords && analysis.keywords.length > 0) {
                    analysisInfo += '<div class="mb-3">' +
                                  '<h5 class="font-medium text-blue-700 mb-2">–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:</h5>' +
                                  '<div class="flex flex-wrap gap-2">';
                    
                    for (var i = 0; i < Math.min(analysis.keywords.length, 8); i++) {
                        var keyword = analysis.keywords[i].word || analysis.keywords[i];
                        analysisInfo += '<span class="semantic-tag">' + keyword + '</span>';
                    }
                    
                    analysisInfo += '</div></div>';
                }
                
                if (analysis.concepts && analysis.concepts.length > 0) {
                    analysisInfo += '<div class="mb-3">' +
                                  '<h5 class="font-medium text-blue-700 mb-2">–ö–æ–Ω—Ü–µ–ø—Ü–∏–∏:</h5>';
                    
                    for (var j = 0; j < Math.min(analysis.concepts.length, 3); j++) {
                        var concept = analysis.concepts[j];
                        analysisInfo += '<div class="text-sm text-blue-600 mb-1">' +
                                      '‚Ä¢ ' + concept.concept + ' (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: ' + concept.relevance + ')</div>';
                    }
                    
                    analysisInfo += '</div>';
                }
                
                analysisInfo += '</div>';
            }
            
            var ethicalInfo = '';
            if (archive.data.ethicalCheck) {
                var ethical = archive.data.ethicalCheck;
                ethicalInfo = 
                    '<div class="mt-4 p-4 ' + (ethical.passed ? 'bg-green-50' : 'bg-red-50') + ' rounded-lg">' +
                        '<h4 class="font-semibold ' + (ethical.passed ? 'text-green-800' : 'text-red-800') + ' mb-2">' +
                            '‚öñÔ∏è –≠—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ' + (ethical.passed ? '–ü—Ä–æ–π–¥–µ–Ω–∞' : '–ù–µ –ø—Ä–æ–π–¥–µ–Ω–∞') +
                        '</h4>' +
                        '<div class="text-sm ' + (ethical.passed ? 'text-green-700' : 'text-red-700') + '">' +
                            '–û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: ' + ethical.safetyScore + '/100' +
                        '</div>' +
                    '</div>';
            }
            
            modalContent.innerHTML = 
                '<div class="space-y-4">' +
                    '<div class="border-b pb-4">' +
                        '<h3 class="text-xl font-semibold text-gray-800">üì¶ –î–µ—Ç–∞–ª–∏ –∞—Ä—Ö–∏–≤–∞</h3>' +
                        '<div class="grid grid-cols-2 gap-4 mt-4 text-sm">' +
                            '<div><strong>ID:</strong> ' + archive.id + '</div>' +
                            '<div><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> L' + archive.level + '</div>' +
                            '<div><strong>–°–æ–∑–¥–∞–Ω:</strong> ' + new Date(archive.timestamp).toLocaleString() + '</div>' +
                            '<div><strong>–†–∞–∑–º–µ—Ä:</strong> ' + this.formatFileSize(archive.size) + '</div>' +
                            '<div><strong>–ó–∞–ø—Ä–æ—Å—á–∏–∫:</strong> ' + (archive.requesterDID.split(':').pop() || '–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω') + '</div>' +
                            '<div><strong>–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞:</strong> ' + (archive.checksum || '–ù–µ –≤—ã—á–∏—Å–ª–µ–Ω–∞') + '</div>' +
                        '</div>' +
                    '</div>' +
                    '<div>' +
                        '<h4 class="font-semibold text-gray-800 mb-2">üìÑ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ</h4>' +
                        '<div class="bg-gray-50 p-4 rounded-lg max-h-64 overflow-y-auto">' +
                            '<pre class="whitespace-pre-wrap text-sm">' + (archive.data.text || '–ù–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ') + '</pre>' +
                        '</div>' +
                    '</div>';
            
            if (archive.data.attachments && archive.data.attachments.length > 0) {
                modalContent.innerHTML += 
                    '<div>' +
                        '<h4 class="font-semibold text-gray-800 mb-2">üìé –í–ª–æ–∂–µ–Ω–∏—è (' + archive.data.attachments.length + ')</h4>' +
                        '<div class="space-y-2">';
                
                for (var k = 0; k < archive.data.attachments.length; k++) {
                    var attachment = archive.data.attachments[k];
                    modalContent.innerHTML += 
                        '<div class="flex justify-between items-center p-2 bg-gray-50 rounded">' +
                            '<span class="text-sm font-medium">' + attachment.name + '</span>' +
                            '<span class="text-xs text-gray-500">' + this.formatFileSize(attachment.size) + '</span>' +
                        '</div>';
                }
                
                modalContent.innerHTML += '</div></div>';
            }
            
            modalContent.innerHTML += analysisInfo + ethicalInfo + '</div>';
            
            modal.classList.remove('hidden');
        };
        
        TerraSemanticIntegration.prototype.formatFileSize = function(bytes) {
            if (bytes === 0) return '0 B';
            
            var k = 1024;
            var sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            var i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        };
        
        TerraSemanticIntegration.prototype.saveAllData = function() {
            this.archiveManager.saveData();
            this.saveIntegrationStats();
            this.showSaveStatus('saved');
        };
        
        TerraSemanticIntegration.prototype.loadSystemData = function() {
            this.archiveManager.loadExistingData();
            this.integrationStats = this.loadIntegrationStats();
        };
        
        TerraSemanticIntegration.prototype.showSaveStatus = function(status) {
            var indicator = document.getElementById('saveIndicator');
            if (!indicator) return;
            
            indicator.className = 'save-indicator ' + status;
            
            switch (status) {
                case 'saving':
                    indicator.innerHTML = 'üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
                    break;
                case 'saved':
                    indicator.innerHTML = '‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
                    break;
                case 'error':
                    indicator.innerHTML = '‚ùå –û—à–∏–±–∫–∞';
                    break;
            }
            
            indicator.classList.remove('hidden');
            
            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(function() {
                indicator.classList.add('hidden');
            }, 3000);
        };
        
        TerraSemanticIntegration.prototype.getSystemInfo = function() {
            return {
                version: this.version,
                author: this.author,
                did: this.did,
                currentLevel: this.currentLevel,
                browserCapabilities: this.browserCapabilities,
                componentsLoaded: {
                    l0Kernel: !!this.l0Kernel,
                    offlineAnalyzer: !!this.offlineAnalyzer,
                    ethicalLayer: !!this.ethicalLayer,
                    archiveManager: !!this.archiveManager
                },
                statistics: this.integrationStats,
                storageStats: this.archiveManager.getStorageStats()
            };
        };
        
        // ===== –ú–ù–û–ì–û–Ø–ó–´–ß–ù–ê–Ø –ü–û–î–î–ï–†–ñ–ö–ê =====
        
        var languageTranslations = {
            'uz': {
                'archive_manager': 'Arxiv Boshqaruvchisi',
                'create_archive': 'Arxiv yaratish',
                'search': 'Qidirish',
                'help': 'Yordam',
                'settings': 'Sozlamalar',
                'hello': 'Salom',
                'thank_you': 'Rahmat',
                'please': 'Iltimos',
                'yes': 'Ha',
                'no': "Yo'q"
            },
            'ru': {
                'archive_manager': '–ú–µ–Ω–µ–¥–∂–µ—Ä –∞—Ä—Ö–∏–≤–æ–≤',
                'create_archive': '–°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤',
                'search': '–ü–æ–∏—Å–∫',
                'help': '–°–ø—Ä–∞–≤–∫–∞',
                'settings': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
                'hello': '–ü—Ä–∏–≤–µ—Ç',
                'thank_you': '–°–ø–∞—Å–∏–±–æ',
                'please': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞',
                'yes': '–î–∞',
                'no': '–ù–µ—Ç'
            },
            'en': {
                'archive_manager': 'Archive Manager',
                'create_archive': 'Create Archive',
                'search': 'Search',
                'help': 'Help',
                'settings': 'Settings',
                'hello': 'Hello',
                'thank_you': 'Thank you',
                'please': 'Please',
                'yes': 'Yes',
                'no': 'No'
            },
            'de': {
                'archive_manager': 'Archiv-Manager',
                'create_archive': 'Archiv erstellen',
                'search': 'Suchen',
                'help': 'Hilfe',
                'settings': 'Einstellungen',
                'hello': 'Hallo',
                'thank_you': 'Danke',
                'please': 'Bitte',
                'yes': 'Ja',
                'no': 'Nein'
            }
        };
        
        function translateText(key, language) {
            language = language || getCurrentLanguage();
            
            if (languageTranslations[language] && languageTranslations[language][key]) {
                return languageTranslations[language][key];
            }
            
            // –í–æ–∑–≤—Ä–∞—Ç –∫ —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            if (languageTranslations['ru'][key]) {
                return languageTranslations['ru'][key];
            }
            
            return key; // –í–æ–∑–≤—Ä–∞—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–ª—é—á–∞, –µ—Å–ª–∏ –ø–µ—Ä–µ–≤–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω
        }
        
        function getCurrentLanguage() {
            var select = document.getElementById('languageSelect');
            return select ? select.value : 'ru';
        }
        
        function switchLanguage(language) {
            localStorage.setItem('terra_language', language);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ select —ç–ª–µ–º–µ–Ω—Ç–∞
            var select = document.getElementById('languageSelect');
            if (select) {
                select.value = language;
            }
            
            // –û–±—ä—è–≤–ª–µ–Ω–∏–µ –¥–ª—è screen reader
            announceToScreenReader('–Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ ' + language);
            
            console.log('üåê –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞:', language);
        }
        
        function loadSavedLanguage() {
            var savedLanguage = localStorage.getItem('terra_language');
            if (savedLanguage) {
                switchLanguage(savedLanguage);
            }
        }
        
        // ===== –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –î–û–°–¢–£–ü–ù–û–°–¢–ò =====
        
        var accessibilitySettings = {
            highContrast: false,
            largeText: false,
            screenReaderSupport: true,
            reducedMotion: false
        };
        
        function toggleAccessibility() {
            var body = document.getElementById('mainBody');
            var isHighContrast = body.classList.contains('accessibility-high-contrast');
            
            if (isHighContrast) {
                // –û—Ç–∫–ª—é—á–∏—Ç—å –≤—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç
                body.classList.remove('accessibility-high-contrast');
                body.classList.remove('accessibility-large-text');
                accessibilitySettings.highContrast = false;
                accessibilitySettings.largeText = false;
                announceToScreenReader('–û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω');
            } else {
                // –í–∫–ª—é—á–∏—Ç—å –≤—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –∏ –∫—Ä—É–ø–Ω—ã–π —Ç–µ–∫—Å—Ç
                body.classList.add('accessibility-high-contrast');
                body.classList.add('accessibility-large-text');
                accessibilitySettings.highContrast = true;
                accessibilitySettings.largeText = true;
                announceToScreenReader('–†–µ–∂–∏–º –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–∫–ª—é—á–µ–Ω');
            }
            
            saveAccessibilitySettings();
        }
        
        function announceToScreenReader(message) {
            // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–ª—è screen reader
            var announcement = document.createElement('div');
            announcement.setAttribute('aria-live', 'polite');
            announcement.setAttribute('aria-atomic', 'true');
            announcement.style.position = 'absolute';
            announcement.style.left = '-10000px';
            announcement.style.width = '1px';
            announcement.style.height = '1px';
            announcement.style.overflow = 'hidden';
            
            announcement.textContent = message;
            document.body.appendChild(announcement);
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
            setTimeout(function() {
                document.body.removeChild(announcement);
            }, 1000);
        }
        
        function saveAccessibilitySettings() {
            localStorage.setItem('terra_accessibility', JSON.stringify(accessibilitySettings));
        }
        
        function loadAccessibilitySettings() {
            try {
                var saved = localStorage.getItem('terra_accessibility');
                if (saved) {
                    accessibilitySettings = JSON.parse(saved);
                    
                    var body = document.getElementById('mainBody');
                    if (accessibilitySettings.highContrast) {
                        body.classList.add('accessibility-high-contrast');
                    }
                    if (accessibilitySettings.largeText) {
                        body.classList.add('accessibility-large-text');
                    }
                }
            } catch (error) {
                console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:', error);
            }
        }
        
        // ===== –°–õ–û–í–ê–†–ù–´–ô –†–ï–ñ–ò–ú =====
        
        var dictionaryMode = false;
        
        var uzbekGermanDictionary = {
            // –ë–∞–∑–æ–≤—ã–µ —Å–ª–æ–≤–∞
            'salom': {
                german: 'Hallo',
                pronunciation: '—Ö–∞ÃÅ–ª–ª–æ',
                category: '–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ',
                example_uz: 'Salom, qanday ahvolingiz?',
                example_de: 'Hallo, wie geht es Ihnen?'
            },
            'rahmat': {
                german: 'Danke',
                pronunciation: '–¥–∞ÃÅ–Ω–∫–µ',
                category: '–≤–µ–∂–ª–∏–≤–æ—Å—Ç—å',
                example_uz: 'Yordam uchun rahmat',
                example_de: 'Danke f√ºr die Hilfe'
            },
            'uy': {
                german: 'Haus',
                pronunciation: '—Ö–∞—É—Å',
                category: '–∂–∏–ª–∏—â–µ',
                example_uz: 'Bizning uyimiz katta',
                example_de: 'Unser Haus ist gro√ü'
            },
            'kitob': {
                german: 'Buch',
                pronunciation: '–±—É—Ö',
                category: '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ',
                example_uz: 'Men kitob o ªqiyapman',
                example_de: 'Ich lese ein Buch'
            },
            'maktab': {
                german: 'Schule',
                pronunciation: '—à—ÉÃÅ–ª–µ',
                category: '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ',
                example_uz: 'Bolalar maktabga borishadi',
                example_de: 'Die Kinder gehen zur Schule'
            },
            'suv': {
                german: 'Wasser',
                pronunciation: '–≤–∞ÃÅ—Å—Å–µ—Ä',
                category: '–ø—Ä–∏—Ä–æ–¥–∞',
                example_uz: 'Toza suv ichish kerak',
                example_de: 'Man sollte sauberes Wasser trinken'
            },
            'non': {
                german: 'Brot',
                pronunciation: '–±—Ä–æ—Ç',
                category: '–µ–¥–∞',
                example_uz: 'Yangi non mazali',
                example_de: 'Frisches Brot ist lecker'
            },
            'vaqt': {
                german: 'Zeit',
                pronunciation: '—Ü–∞–π—Ç',
                category: '–≤—Ä–µ–º—è',
                example_uz: 'Vaqt juda tez o ªtadi',
                example_de: 'Die Zeit vergeht sehr schnell'
            },
            'ish': {
                german: 'Arbeit',
                pronunciation: '–∞ÃÅ—Ä–±–∞–π—Ç',
                category: '–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
                example_uz: 'Menga bu ish yoqadi',
                example_de: 'Diese Arbeit gef√§llt mir'
            },
            'oila': {
                german: 'Familie',
                pronunciation: '—Ñ–∞–º–∏ÃÅ–ª–∏–µ',
                category: '—Å–µ–º—å—è',
                example_uz: 'Oila eng muhim narsa',
                example_de: 'Familie ist das Wichtigste'
            }
        };
        
        function toggleDictionaryMode() {
            dictionaryMode = !dictionaryMode;
            
            var button = document.getElementById('dictionaryModeToggle');
            if (button) {
                if (dictionaryMode) {
                    button.textContent = 'üìö –°–ª–æ–≤–∞—Ä—å (–í–ö–õ)';
                    button.classList.add('pulse-glow');
                } else {
                    button.textContent = 'üìö –°–ª–æ–≤–∞—Ä—å';
                    button.classList.remove('pulse-glow');
                }
            }
            
            announceToScreenReader(dictionaryMode ? '–°–ª–æ–≤–∞—Ä–Ω—ã–π —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω' : '–°–ª–æ–≤–∞—Ä–Ω—ã–π —Ä–µ–∂–∏–º –≤—ã–∫–ª—é—á–µ–Ω');
        }
        
        function searchDictionary() {
            var query = document.getElementById('dictionarySearch').value.trim().toLowerCase();
            var resultsContainer = document.getElementById('dictionaryResults');
            
            if (!resultsContainer) return;
            
            if (!query) {
                resultsContainer.innerHTML = 
                    '<div class="text-center py-8 text-gray-500">' +
                        '<div class="text-4xl mb-4">üìö</div>' +
                        '<p>–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞</p>' +
                    '</div>';
                return;
            }
            
            var results = [];
            
            // –ü–æ–∏—Å–∫ –≤ —Å–ª–æ–≤–∞—Ä–µ
            for (var word in uzbekGermanDictionary) {
                if (word.indexOf(query) !== -1) {
                    results.push({
                        uzbek: word,
                        data: uzbekGermanDictionary[word],
                        relevance: word.indexOf(query) === 0 ? 1 : 0.5
                    });
                }
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
            results.sort(function(a, b) { return b.relevance - a.relevance; });
            
            if (results.length === 0) {
                resultsContainer.innerHTML = 
                    '<div class="text-center py-8 text-gray-500">' +
                        '<div class="text-4xl mb-4">üîç</div>' +
                        '<h3 class="text-xl font-semibold mb-2">–ü–µ—Ä–µ–≤–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω</h3>' +
                        '<p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–µ —Å–ª–æ–≤–æ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–æ–ø–∏—Å–∞–Ω–∏–µ</p>' +
                    '</div>';
                return;
            }
            
            resultsContainer.innerHTML = '';
            
            for (var i = 0; i < results.length; i++) {
                var result = results[i];
                var resultElement = document.createElement('div');
                resultElement.className = 'definition-card mb-4';
                
                resultElement.innerHTML = 
                    '<div class="flex justify-between items-start mb-4">' +
                        '<div>' +
                            '<h3 class="text-xl font-bold text-teal-800">' + result.uzbek + '</h3>' +
                            '<p class="text-lg text-gray-700">' + result.data.german + '</p>' +
                            '<p class="text-sm text-gray-500">–ü—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ: ' + result.data.pronunciation + '</p>' +
                        '</div>' +
                        '<div class="text-right">' +
                            '<span class="inline-block px-3 py-1 bg-teal-200 text-teal-800 text-xs rounded-full">' + 
                                result.data.category + 
                            '</span>' +
                        '</div>' +
                    '</div>' +
                    '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">' +
                        '<div>' +
                            '<h4 class="font-semibold text-gray-700 mb-1">üá∫üáø –£–∑–±–µ–∫—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä:</h4>' +
                            '<p class="text-sm text-gray-600">' + result.data.example_uz + '</p>' +
                        '</div>' +
                        '<div>' +
                            '<h4 class="font-semibold text-gray-700 mb-1">üá©üá™ –ù–µ–º–µ—Ü–∫–∏–π –ø—Ä–∏–º–µ—Ä:</h4>' +
                            '<p class="text-sm text-gray-600">' + result.data.example_de + '</p>' +
                        '</div>' +
                    '</div>';
                
                resultsContainer.appendChild(resultElement);
            }
            
            announceToScreenReader('–ù–∞–π–¥–µ–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–æ–≤: ' + results.length);
        }
        
        // ===== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê =====
        
        var terraSystem; // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º—ã
        
        function initializeTerraSystem() {
            terraSystem = new TerraSemanticIntegration();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
            loadSavedLanguage();
            loadAccessibilitySettings();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            setupEventHandlers();
            
            console.log("üåç Terra Archive Manager 2.0 Ultimate –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!");
        }
        
        function setupEventHandlers() {
            // –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
            var languageSelect = document.getElementById('languageSelect');
            if (languageSelect) {
                languageSelect.addEventListener('change', function() {
                    switchLanguage(this.value);
                });
            }
            
            // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            var accessibilityToggle = document.getElementById('accessibilityToggle');
            if (accessibilityToggle) {
                accessibilityToggle.addEventListener('click', toggleAccessibility);
            }
            
            var dictionaryToggle = document.getElementById('dictionaryModeToggle');
            if (dictionaryToggle) {
                dictionaryToggle.addEventListener('click', toggleDictionaryMode);
            }
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º
            var searchBox = document.getElementById('searchBox');
            if (searchBox) {
                searchBox.addEventListener('input', function() {
                    if (this.value.length > 2) {
                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø—Ä–∏ –≤–≤–æ–¥–µ
                        clearTimeout(this.searchTimeout);
                        this.searchTimeout = setTimeout(function() {
                            performCorpusSearch();
                        }, 500);
                    }
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
            var modal = document.getElementById('contentModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeModal();
                    }
                });
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(function() {
                if (terraSystem) {
                    terraSystem.saveAllData();
                }
            }, 30000);
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∞–º–∏
        function processArchiveRequest() {
            var requestText = document.getElementById('archiveRequest').value.trim();
            var requesterDID = document.getElementById('requesterDID').value.trim();
            
            if (!requestText) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞');
                return;
            }
            
            if (!requesterDID) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ DID –∑–∞–ø—Ä–æ—Å—á–∏–∫–∞');
                return;
            }
            
            terraSystem.showSaveStatus('saving');
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
            var fileInput = document.getElementById('fileInput');
            var attachments = [];
            
            if (fileInput && fileInput.files) {
                for (var i = 0; i < fileInput.files.length; i++) {
                    var file = fileInput.files[i];
                    attachments.push({
                        name: file.name,
                        size: file.size,
                        type: file.type,
                        lastModified: file.lastModified
                    });
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            showProcessingProgress();
            
            // –°–∏–º—É–ª—è—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
            setTimeout(function() {
                var result = terraSystem.processArchiveRequest(requestText, attachments, requesterDID);
                
                hideProcessingProgress();
                
                if (result.success) {
                    alert('‚úÖ –ê—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!\n\n' +
                          'üì¶ ID –∞—Ä—Ö–∏–≤–∞: ' + result.archiveId + '\n' +
                          'üß¨ –£—Ä–æ–≤–µ–Ω—å: L' + result.level + '\n' +
                          'üíæ –†–∞–∑–º–µ—Ä: ' + terraSystem.formatFileSize(result.size));
                    
                    // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
                    document.getElementById('archiveRequest').value = '';
                    if (fileInput) fileInput.value = '';
                    
                    terraSystem.updateUI();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–∞:\n\n' + result.error);
                }
                
                terraSystem.showSaveStatus('saved');
            }, 1000);
        }
        
        function performCorpusSearch() {
            var query = document.getElementById('searchBox').value.trim();
            var searchMode = document.getElementById('searchMode').value;
            
            if (!query) {
                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å');
                return;
            }
            
            terraSystem.showSaveStatus('saving');
            
            var options = {
                mode: searchMode
            };
            
            var results = terraSystem.searchArchive(query, options);
            
            displaySearchResults(results);
            terraSystem.showSaveStatus('saved');
        }
        
        function displaySearchResults(searchResults) {
            var container = document.getElementById('archivesList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (searchResults.totalFound === 0) {
                container.innerHTML = 
                    '<div class="text-center py-12 text-gray-500">' +
                        '<div class="text-6xl mb-6">üîç</div>' +
                        '<h3 class="text-xl font-semibold mb-2">–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>' +
                        '<p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>' +
                    '</div>';
                return;
            }
            
            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            var headerElement = document.createElement('div');
            headerElement.className = 'bg-blue-50 p-4 rounded-lg mb-4';
            headerElement.innerHTML = 
                '<div class="flex justify-between items-center">' +
                    '<h3 class="text-lg font-semibold text-blue-800">üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</h3>' +
                    '<div class="text-sm text-blue-600">' +
                        '–ù–∞–π–¥–µ–Ω–æ: ' + searchResults.totalFound + ' ‚Ä¢ ' +
                        '–í—Ä–µ–º—è: ' + searchResults.processingTime + '–º—Å ‚Ä¢ ' +
                        '–ú–µ—Ç–æ–¥: ' + searchResults.searchMethod +
                    '</div>' +
                '</div>';
            
            container.appendChild(headerElement);
            
            // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞
            for (var i = 0; i < searchResults.results.length; i++) {
                var result = searchResults.results[i];
                var archive = result.item;
                
                var resultElement = document.createElement('div');
                resultElement.className = 'archive-item border-l-4 border-blue-500';
                
                var relevanceBar = '';
                if (result.similarity !== undefined) {
                    var similarity = Math.round(result.similarity * 100);
                    relevanceBar = 
                        '<div class="mt-2">' +
                            '<div class="flex justify-between text-xs text-gray-500 mb-1">' +
                                '<span>–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å</span>' +
                                '<span>' + similarity + '%</span>' +
                            '</div>' +
                            '<div class="progress-bar h-2">' +
                                '<div class="progress-fill h-2" style="width: ' + similarity + '%"></div>' +
                            '</div>' +
                        '</div>';
                }
                
                var matchedConcepts = '';
                if (result.matchedConcepts && result.matchedConcepts.length > 0) {
                    matchedConcepts = 
                        '<div class="mt-2">' +
                            '<div class="text-xs text-gray-500 mb-1">–°–æ–≤–ø–∞–¥–∞—é—â–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:</div>' +
                            '<div class="flex flex-wrap gap-1">';
                    
                    for (var j = 0; j < result.matchedConcepts.length; j++) {
                        matchedConcepts += '<span class="semantic-tag text-xs">' + result.matchedConcepts[j] + '</span>';
                    }
                    
                    matchedConcepts += '</div></div>';
                }
                
                resultElement.innerHTML = 
                    '<div class="flex justify-between items-start">' +
                        '<div class="flex-1">' +
                            '<h4 class="font-semibold text-gray-800 mb-1">üì¶ –ê—Ä—Ö–∏–≤ #' + archive.id.slice(-6) + '</h4>' +
                            '<p class="text-sm text-gray-600 mb-2">' + new Date(archive.timestamp).toLocaleString() + '</p>' +
                            '<p class="text-sm text-gray-700 line-clamp-2">' + (archive.data.text || '–§–∞–π–ª–æ–≤—ã–π –∞—Ä—Ö–∏–≤').slice(0, 100) + '...</p>' +
                            relevanceBar +
                            matchedConcepts +
                        '</div>' +
                        '<div class="text-right ml-4">' +
                            '<div class="text-sm text-gray-500">' + terraSystem.formatFileSize(archive.size) + '</div>' +
                            '<div class="text-xs text-purple-600 font-semibold">L' + archive.level + '</div>' +
                        '</div>' +
                    '</div>';
                
                resultElement.onclick = (function(archive) {
                    return function() {
                        terraSystem.showArchiveDetails(archive);
                    };
                })(archive);
                
                container.appendChild(resultElement);
            }
        }
        
        function showProcessingProgress() {
            var progress = document.getElementById('processingProgress');
            var progressFill = document.getElementById('progressFill');
            var progressText = document.getElementById('progressText');
            
            if (progress) {
                progress.classList.remove('hidden');
                
                var currentProgress = 0;
                var progressInterval = setInterval(function() {
                    currentProgress += Math.random() * 30;
                    if (currentProgress > 100) {
                        currentProgress = 100;
                        clearInterval(progressInterval);
                    }
                    
                    if (progressFill) {
                        progressFill.style.width = currentProgress + '%';
                    }
                    
                    if (progressText) {
                        if (currentProgress < 30) {
                            progressText.textContent = '–ê–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ...';
                        } else if (currentProgress < 60) {
                            progressText.textContent = '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞...';
                        } else if (currentProgress < 90) {
                            progressText.textContent = '–≠—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞...';
                        } else {
                            progressText.textContent = '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞...';
                        }
                    }
                }, 200);
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—á–∏—Å—Ç–∫–∏
                progress.progressInterval = progressInterval;
            }
        }
        
        function hideProcessingProgress() {
            var progress = document.getElementById('processingProgress');
            
            if (progress) {
                if (progress.progressInterval) {
                    clearInterval(progress.progressInterval);
                }
                progress.classList.add('hidden');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∞–º–∏
        function switchTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            var tabs = ['thesaurus', 'encyclopedia', 'semantic', 'dictionary'];
            
            for (var i = 0; i < tabs.length; i++) {
                var tab = tabs[i];
                var tabContent = document.getElementById(tab + 'Tab');
                var tabButton = document.querySelector('[data-tab="' + tab + '"]');
                
                if (tabContent) {
                    tabContent.classList.add('hidden');
                }
                
                if (tabButton) {
                    tabButton.classList.remove('active');
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            var selectedTabContent = document.getElementById(tabName + 'Tab');
            var selectedTabButton = document.querySelector('[data-tab="' + tabName + '"]');
            
            if (selectedTabContent) {
                selectedTabContent.classList.remove('hidden');
            }
            
            if (selectedTabButton) {
                selectedTabButton.classList.add('active');
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–∫–ª–∞–¥–∫–∏
            if (tabName === 'thesaurus') {
                loadThesaurusContent();
            } else if (tabName === 'encyclopedia') {
                loadEncyclopediaContent();
            } else if (tabName === 'semantic') {
                loadSemanticAnalysisContent();
            }
        }
        
        function loadThesaurusContent() {
            var container = document.getElementById('thesaurusList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (terraSystem.archiveManager.thesaurus.length === 0) {
                container.innerHTML = 
                    '<div class="text-center py-8 text-gray-500">' +
                        '<div class="text-4xl mb-4">üìö</div>' +
                        '<h3 class="text-xl font-semibold mb-2">–¢–µ–∑–∞—É—Ä—É—Å –ø—É—Å—Ç</h3>' +
                        '<p>–°–æ–∑–¥–∞–π—Ç–µ –∞—Ä—Ö–∏–≤—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–µ–∑–∞—É—Ä—É—Å–∞</p>' +
                    '</div>';
                return;
            }
            
            for (var i = 0; i < terraSystem.archiveManager.thesaurus.length; i++) {
                var entry = terraSystem.archiveManager.thesaurus[i];
                var entryElement = document.createElement('div');
                entryElement.className = 'definition-card';
                
                entryElement.innerHTML = 
                    '<div class="flex justify-between items-start mb-3">' +
                        '<h4 class="text-lg font-semibold text-teal-800">' + entry.term + '</h4>' +
                        '<span class="text-xs text-teal-600 bg-teal-100 px-2 py-1 rounded">' + entry.category + '</span>' +
                    '</div>' +
                    '<p class="text-gray-700 mb-3">' + entry.definition + '</p>' +
                    '<div class="flex flex-wrap gap-2">';
                
                if (entry.synonyms && entry.synonyms.length > 0) {
                    for (var j = 0; j < entry.synonyms.length; j++) {
                        entryElement.innerHTML += '<span class="semantic-tag text-xs">' + entry.synonyms[j] + '</span>';
                    }
                }
                
                entryElement.innerHTML += '</div>';
                container.appendChild(entryElement);
            }
        }
        
        function loadEncyclopediaContent() {
            var container = document.getElementById('encyclopediaList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (terraSystem.archiveManager.encyclopedia.length === 0) {
                container.innerHTML = 
                    '<div class="text-center py-8 text-gray-500">' +
                        '<div class="text-4xl mb-4">üî¨</div>' +
                        '<h3 class="text-xl font-semibold mb-2">–≠–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è –ø—É—Å—Ç–∞</h3>' +
                        '<p>–°–æ–∑–¥–∞–π—Ç–µ –∞—Ä—Ö–∏–≤—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏</p>' +
                    '</div>';
                return;
            }
            
            for (var i = 0; i < terraSystem.archiveManager.encyclopedia.length; i++) {
                var entry = terraSystem.archiveManager.encyclopedia[i];
                var entryElement = document.createElement('div');
                entryElement.className = 'encyclopedia-entry';
                
                entryElement.innerHTML = 
                    '<div class="flex justify-between items-start mb-3">' +
                        '<h4 class="text-lg font-semibold text-purple-800">' + entry.concept + '</h4>' +
                        '<span class="text-xs text-purple-600 bg-purple-100 px-2 py-1 rounded">' + entry.domain + '</span>' +
                    '</div>' +
                    '<p class="text-gray-700 mb-3">' + entry.description + '</p>' +
                    '<div class="text-sm text-gray-600">' +
                        '<strong>–°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:</strong> ' + (entry.relatedConcepts ? entry.relatedConcepts.join(', ') : '–ù–µ—Ç') +
                    '</div>';
                
                container.appendChild(entryElement);
            }
        }
        
        function loadSemanticAnalysisContent() {
            var container = document.getElementById('semanticAnalysis');
            if (!container) return;
            
            var stats = terraSystem.integrationStats;
            var systemInfo = terraSystem.getSystemInfo();
            
            container.innerHTML = 
                '<div class="grid grid-cols-2 gap-6">' +
                    '<div class="bg-blue-50 p-6 rounded-lg">' +
                        '<h4 class="text-lg font-semibold text-blue-800 mb-4">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏</h4>' +
                        '<div class="space-y-3">' +
                            '<div class="flex justify-between">' +
                                '<span class="text-blue-700">–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ:</span>' +
                                '<span class="font-semibold">' + stats.totalProcessed + '</span>' +
                            '</div>' +
                            '<div class="flex justify-between">' +
                                '<span class="text-blue-700">–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤:</span>' +
                                '<span class="font-semibold">' + stats.semanticAnalyses + '</span>' +
                            '</div>' +
                            '<div class="flex justify-between">' +
                                '<span class="text-blue-700">–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:</span>' +
                                '<span class="font-semibold">' + stats.ethicalChecks + '</span>' +
                            '</div>' +
                            '<div class="flex justify-between">' +
                                '<span class="text-blue-700">–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:</span>' +
                                '<span class="font-semibold">' + stats.archiveOperations + '</span>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="bg-green-50 p-6 rounded-lg">' +
                        '<h4 class="text-lg font-semibold text-green-800 mb-4">üß¨ –£—Ä–æ–≤–µ–Ω—å —Å–∏—Å—Ç–µ–º—ã</h4>' +
                        '<div class="space-y-3">' +
                            '<div class="flex justify-between">' +
                                '<span class="text-green-700">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å:</span>' +
                                '<span class="font-semibold">L' + systemInfo.currentLevel + '</span>' +
                            '</div>' +
                            '<div class="flex justify-between">' +
                                '<span class="text-green-700">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å:</span>' +
                                '<span class="font-semibold">L' + terraSystem.determineMaxLevel() + '</span>' +
                            '</div>' +
                            '<div class="flex justify-between">' +
                                '<span class="text-green-700">–ë—Ä–∞—É–∑–µ—Ä:</span>' +
                                '<span class="font-semibold">' + systemInfo.browserCapabilities.browserFamily + '</span>' +
                            '</div>' +
                            '<div class="flex justify-between">' +
                                '<span class="text-green-700">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</span>' +
                                '<span class="font-semibold">' + systemInfo.browserCapabilities.processingPower + '</span>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                '<div class="mt-6 bg-yellow-50 p-6 rounded-lg">' +
                    '<h4 class="text-lg font-semibold text-yellow-800 mb-4">‚ö° –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞</h4>' +
                    '<div class="grid grid-cols-4 gap-4 text-sm">' +
                        '<div class="text-center">' +
                            '<div class="text-2xl mb-2">' + (systemInfo.browserCapabilities.es6Support ? '‚úÖ' : '‚ùå') + '</div>' +
                            '<div class="text-yellow-700">ES6 Support</div>' +
                        '</div>' +
                        '<div class="text-center">' +
                            '<div class="text-2xl mb-2">' + (systemInfo.browserCapabilities.localStorageSupport ? '‚úÖ' : '‚ùå') + '</div>' +
                            '<div class="text-yellow-700">LocalStorage</div>' +
                        '</div>' +
                        '<div class="text-center">' +
                            '<div class="text-2xl mb-2">' + (systemInfo.browserCapabilities.indexedDBSupport ? '‚úÖ' : '‚ùå') + '</div>' +
                            '<div class="text-yellow-700">IndexedDB</div>' +
                        '</div>' +
                        '<div class="text-center">' +
                            '<div class="text-2xl mb-2">' + (systemInfo.browserCapabilities.webWorkersSupport ? '‚úÖ' : '‚ùå') + '</div>' +
                            '<div class="text-yellow-700">Web Workers</div>' +
                        '</div>' +
                    '</div>' +
                '</div>';
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª–∞–º–∏
        function closeModal() {
            var modal = document.getElementById('contentModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π
        function upgradeSystemLevel() {
            var maxLevel = terraSystem.determineMaxLevel();
            
            if (terraSystem.currentLevel >= maxLevel) {
                alert('‚ö†Ô∏è –£–∂–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –≤–∞—à–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞\n\n' +
                      '–¢–µ–∫—É—â–∏–π: L' + terraSystem.currentLevel + '\n' +
                      '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π: L' + maxLevel + '\n\n' +
                      '–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –±–æ–ª—å—à–µ RAM');
                return;
            }
            
            terraSystem.currentLevel++;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
            if (terraSystem.currentLevel >= 1 && !terraSystem.offlineAnalyzer) {
                terraSystem.offlineAnalyzer = new OfflineSemanticAnalyzer();
                terraSystem.offlineAnalyzer.initialize();
            }
            
            terraSystem.updateUI();
            terraSystem.saveAllData();
            
            alert('‚¨ÜÔ∏è –£—Ä–æ–≤–µ–Ω—å —Å–∏—Å—Ç–µ–º—ã –ø–æ–≤—ã—à–µ–Ω!\n\n' +
                  '–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: L' + terraSystem.currentLevel + '\n' +
                  '–î–æ—Å—Ç—É–ø–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω—ã');
        }
        
        function resetToL0() {
            if (confirm('üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∫ –±–∞–∑–æ–≤–æ–º—É —É—Ä–æ–≤–Ω—é L0?\n\n–≠—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –Ω–æ –Ω–µ —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ.')) {
                terraSystem.currentLevel = 0;
                terraSystem.offlineAnalyzer = null; // –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞
                
                terraSystem.updateUI();
                terraSystem.saveAllData();
                
                alert('üîÑ –°–∏—Å—Ç–µ–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞ –∫ —É—Ä–æ–≤–Ω—é L0\n\n–¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏');
            }
        }
        
        function organizeAll() {
            alert('üìÅ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∞—Ä—Ö–∏–≤–æ–≤\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–í —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç–Ω—ã–º –æ–±–ª–∞—Å—Ç—è–º.');
        }
        
        function optimizeForCurrentLevel() {
            terraSystem.showSaveStatus('saving');
            
            // –ü—Ä–æ—Å—Ç–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
            var optimizationResults = {
                removedDuplicates: 0,
                compressedArchives: 0,
                freedSpace: 0
            };
            
            setTimeout(function() {
                terraSystem.showSaveStatus('saved');
                
                alert('üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\n\n' +
                      '‚ú® –£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: ' + optimizationResults.removedDuplicates + '\n' +
                      'üì¶ –°–∂–∞—Ç–æ –∞—Ä—Ö–∏–≤–æ–≤: ' + optimizationResults.compressedArchives + '\n' +
                      'üíæ –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ –º–µ—Å—Ç–∞: ' + terraSystem.formatFileSize(optimizationResults.freedSpace));
            }, 1500);
        }
        
        function generateUltimateReport() {
            var systemInfo = terraSystem.getSystemInfo();
            var stats = terraSystem.integrationStats;
            var storageStats = terraSystem.archiveManager.getStorageStats();
            var ethicalReport = terraSystem.ethicalLayer.generateEthicalReport();
            
            var report = 'üìä ULTIMATE –û–¢–ß–ï–¢ TERRA –°–ò–°–¢–ï–ú–´\n\n';
            
            report += 'üß¨ –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:\n';
            report += '–í–µ—Ä—Å–∏—è: ' + systemInfo.version + '\n';
            report += '–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: L' + systemInfo.currentLevel + '\n';
            report += '–ê–≤—Ç–æ—Ä: ' + systemInfo.author + '\n';
            report += 'DID: ' + systemInfo.did + '\n\n';
            
            report += 'üì¶ –ê–†–•–ò–í–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n';
            report += '–í—Å–µ–≥–æ –∞—Ä—Ö–∏–≤–æ–≤: ' + storageStats.totalArchives + '\n';
            report += '–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: ' + terraSystem.formatFileSize(storageStats.totalSize) + '\n';
            report += '–ó–∞–ø–∏—Å–µ–π —Ç–µ–∑–∞—É—Ä—É—Å–∞: ' + storageStats.thesaurusEntries + '\n';
            report += '–ó–∞–ø–∏—Å–µ–π —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏: ' + storageStats.encyclopediaEntries + '\n\n';
            
            report += 'üß† –û–ë–†–ê–ë–û–¢–ö–ê –î–ê–ù–ù–´–•:\n';
            report += '–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ' + stats.totalProcessed + '\n';
            report += '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤: ' + stats.semanticAnalyses + '\n';
            report += '–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + stats.ethicalChecks + '\n';
            report += '–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: ' + stats.archiveOperations + '\n\n';
            
            report += '‚öñÔ∏è –≠–¢–ò–ß–ï–°–ö–ê–Ø –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:\n';
            report += '–í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + ethicalReport.statistics.totalChecks + '\n';
            report += '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ' + ethicalReport.statistics.blockedContent + '\n';
            report += '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤—ã–¥–∞–Ω–æ: ' + ethicalReport.statistics.warningsIssued + '\n';
            report += '–£–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ' + ethicalReport.statistics.enhancedContent + '\n\n';
            
            report += 'üåê –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –ë–†–ê–£–ó–ï–†–ê:\n';
            report += 'ES6 –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (systemInfo.browserCapabilities.es6Support ? '‚úÖ' : '‚ùå') + '\n';
            report += 'LocalStorage: ' + (systemInfo.browserCapabilities.localStorageSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += 'IndexedDB: ' + (systemInfo.browserCapabilities.indexedDBSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Web Workers: ' + (systemInfo.browserCapabilities.webWorkersSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += '–°–µ–º–µ–π—Å—Ç–≤–æ –±—Ä–∞—É–∑–µ—Ä–∞: ' + systemInfo.browserCapabilities.browserFamily + '\n';
            report += '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ' + systemInfo.browserCapabilities.processingPower + '\n';
            report += '–û—Ü–µ–Ω–æ—á–Ω–∞—è RAM: ' + systemInfo.browserCapabilities.estimatedRAM + ' MB\n\n';
            
            if (stats.lastActivity) {
                report += '‚è∞ –ü–û–°–õ–ï–î–ù–Ø–Ø –ê–ö–¢–ò–í–ù–û–°–¢–¨:\n';
                report += new Date(stats.lastActivity).toLocaleString() + '\n\n';
            }
            
            report += 'üåç TERRA ARCHIVE MANAGER 2.0 ULTIMATE\n';
            report += '–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è';
            
            alert(report);
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
        function handleFiles(files) {
            var fileList = [];
            
            for (var i = 0; i < files.length; i++) {
                var file = files[i];
                fileList.push({
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    lastModified: file.lastModified
                });
            }
            
            if (fileList.length > 0) {
                console.log('–í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:', fileList.length);
                announceToScreenReader('–í—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ' + fileList.length);
            }
        }
        
        // Drag & Drop –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        function dropHandler(event) {
            event.preventDefault();
            
            var dropZone = document.getElementById('dropZone');
            if (dropZone) {
                dropZone.classList.remove('dragover');
            }
            
            var files = event.dataTransfer.files;
            handleFiles(files);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ input
            var fileInput = document.getElementById('fileInput');
            if (fileInput) {
                fileInput.files = files;
            }
        }
        
        function dragOverHandler(event) {
            event.preventDefault();
            
            var dropZone = document.getElementById('dropZone');
            if (dropZone) {
                dropZone.classList.add('dragover');
            }
        }
        
        function dragLeaveHandler(event) {
            event.preventDefault();
            
            var dropZone = document.getElementById('dropZone');
            if (dropZone) {
                dropZone.classList.remove('dragover');
            }
        }
        
        // ===== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====
        
        // –§—É–Ω–∫—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞
        window.exportThesaurus = function() {
            var thesaurusData = {
                metadata: {
                    systemName: "Terra Archive Manager 2.0 Ultimate",
                    version: terraSystem.version,
                    author: terraSystem.author,
                    did: terraSystem.did,
                    exportDate: new Date().toISOString(),
                    type: "thesaurus"
                },
                data: terraSystem.archiveManager.thesaurus
            };
            
            var dataStr = JSON.stringify(thesaurusData, null, 2);
            var dataBlob = new Blob([dataStr], {type: 'application/json'});
            var url = URL.createObjectURL(dataBlob);
            
            var link = document.createElement('a');
            link.href = url;
            link.download = 'terra_thesaurus_' + new Date().toISOString().slice(0, 10) + '.json';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            
            alert('‚úÖ –¢–µ–∑–∞—É—Ä—É—Å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!\n\n' +
                  '–ó–∞–ø–∏—Å–µ–π: ' + terraSystem.archiveManager.thesaurus.length);
        };

        // –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∑–∞–ø—Ä–æ—Å—É
        window.performSemanticAnalysis = function() {
            var text = prompt('üß† –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:');
            if (!text) return;
            
            terraSystem.showSaveStatus('saving');
            
            var analysis;
            if (terraSystem.currentLevel >= 1 && terraSystem.offlineAnalyzer) {
                analysis = terraSystem.offlineAnalyzer.analyzeText(text);
            } else {
                analysis = terraSystem.l0Kernel.processRequest(text, terraSystem.did);
            }
            
            terraSystem.integrationStats.semanticAnalyses++;
            terraSystem.saveIntegrationStats();
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
            var resultsDiv = document.getElementById('semanticAnalysis');
            if (resultsDiv) {
                var resultsHTML = '<div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg border border-blue-200 mb-6">';
                resultsHTML += '<h4 class="text-xl font-semibold text-blue-800 mb-4">üß† –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</h4>';
                
                // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                resultsHTML += '<div class="grid grid-cols-3 gap-4 mb-6">';
                resultsHTML += '<div class="text-center p-3 bg-white rounded-lg shadow-sm">';
                resultsHTML += '<div class="text-2xl font-bold text-blue-600">' + (analysis.wordCount || text.split(' ').length) + '</div>';
                resultsHTML += '<div class="text-sm text-blue-700">–°–ª–æ–≤</div>';
                resultsHTML += '</div>';
                resultsHTML += '<div class="text-center p-3 bg-white rounded-lg shadow-sm">';
                resultsHTML += '<div class="text-2xl font-bold text-green-600">' + (analysis.processingTime || 0) + '</div>';
                resultsHTML += '<div class="text-sm text-green-700">–º—Å</div>';
                resultsHTML += '</div>';
                resultsHTML += '<div class="text-center p-3 bg-white rounded-lg shadow-sm">';
                resultsHTML += '<div class="text-2xl font-bold text-purple-600">L' + terraSystem.currentLevel + '</div>';
                resultsHTML += '<div class="text-sm text-purple-700">–£—Ä–æ–≤–µ–Ω—å</div>';
                resultsHTML += '</div>';
                resultsHTML += '</div>';
                
                // Keywords
                if (analysis.keywords && analysis.keywords.length > 0) {
                    resultsHTML += '<div class="mb-4">';
                    resultsHTML += '<h5 class="font-medium text-gray-700 mb-2">üî§ –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:</h5>';
                    resultsHTML += '<div class="flex flex-wrap gap-2">';
                    for (var i = 0; i < Math.min(analysis.keywords.length, 10); i++) {
                        var keyword = analysis.keywords[i];
                        var word = keyword.word || keyword;
                        var freq = keyword.frequency || 1;
                        resultsHTML += '<span class="semantic-tag" title="–ß–∞—Å—Ç–æ—Ç–∞: ' + freq + '">' + word + '</span>';
                    }
                    resultsHTML += '</div></div>';
                }
                
                // Concepts
                if (analysis.concepts && analysis.concepts.length > 0) {
                    resultsHTML += '<div class="mb-4">';
                    resultsHTML += '<h5 class="font-medium text-gray-700 mb-2">üí° –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏:</h5>';
                    for (var j = 0; j < Math.min(analysis.concepts.length, 5); j++) {
                        var concept = analysis.concepts[j];
                        resultsHTML += '<div class="bg-yellow-50 p-2 rounded mb-2">';
                        resultsHTML += '<span class="font-medium text-yellow-700">' + concept.concept + '</span>';
                        resultsHTML += '<span class="text-sm text-yellow-600 ml-2">(—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: ' + Math.round(concept.relevance * 100) + '%)</span>';
                        resultsHTML += '</div>';
                    }
                    resultsHTML += '</div>';
                }
                
                // Domains (if available)
                if (analysis.domains && analysis.domains.length > 0) {
                    resultsHTML += '<div class="mb-4">';
                    resultsHTML += '<h5 class="font-medium text-gray-700 mb-2">üè∑Ô∏è –ü—Ä–µ–¥–º–µ—Ç–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏:</h5>';
                    for (var k = 0; k < Math.min(analysis.domains.length, 3); k++) {
                        var domain = analysis.domains[k];
                        resultsHTML += '<div class="bg-purple-50 p-2 rounded mb-2">';
                        resultsHTML += '<span class="font-medium text-purple-700">' + domain.domain + '</span>';
                        resultsHTML += '<span class="text-sm text-purple-600 ml-2">(—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: ' + Math.round(domain.confidence * 100) + '%)</span>';
                        resultsHTML += '</div>';
                    }
                    resultsHTML += '</div>';
                }
                
                // Ethical check results
                var ethicalCheck = terraSystem.ethicalLayer.validateContent(text);
                resultsHTML += '<div class="mb-4">';
                resultsHTML += '<h5 class="font-medium text-gray-700 mb-2">‚öñÔ∏è –≠—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:</h5>';
                resultsHTML += '<div class="' + (ethicalCheck.passed ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200') + ' p-3 rounded border">';
                resultsHTML += '<div class="flex items-center mb-2">';
                resultsHTML += '<span class="' + (ethicalCheck.passed ? 'text-green-700' : 'text-red-700') + ' font-medium">';
                resultsHTML += ethicalCheck.passed ? '‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞' : '‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–∞—Ä—É—à–µ–Ω–∏—è';
                resultsHTML += '</span></div>';
                
                if (ethicalCheck.violations && ethicalCheck.violations.length > 0) {
                    resultsHTML += '<div class="text-sm text-red-700 mb-2"><strong>–ù–∞—Ä—É—à–µ–Ω–∏—è:</strong></div>';
                    for (var l = 0; l < ethicalCheck.violations.length; l++) {
                        resultsHTML += '<div class="text-sm text-red-600">‚Ä¢ ' + ethicalCheck.violations[l].message + '</div>';
                    }
                }
                
                if (ethicalCheck.enhancements && ethicalCheck.enhancements.length > 0) {
                    resultsHTML += '<div class="text-sm text-green-700 mb-2"><strong>–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:</strong></div>';
                    for (var m = 0; m < ethicalCheck.enhancements.length; m++) {
                        resultsHTML += '<div class="text-sm text-green-600">‚Ä¢ ' + ethicalCheck.enhancements[m].message + '</div>';
                    }
                }
                resultsHTML += '</div></div>';
                
                // Summary
                if (analysis.summary) {
                    resultsHTML += '<div class="mb-4">';
                    resultsHTML += '<h5 class="font-medium text-gray-700 mb-2">üìã –†–µ–∑—é–º–µ:</h5>';
                    resultsHTML += '<div class="bg-blue-50 p-3 rounded border border-blue-200">';
                    resultsHTML += '<p class="text-sm text-blue-800">' + analysis.summary + '</p>';
                    resultsHTML += '</div></div>';
                }
                
                resultsHTML += '</div>';
                
                // –í—Å—Ç–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –Ω–∞—á–∞–ª–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                resultsDiv.innerHTML = resultsHTML + resultsDiv.innerHTML;
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
                switchTab('semantic');
            }
            
            terraSystem.showSaveStatus('saved');
        };
        
        // Additional Terra functions
        window.exportUltimateArchive = function() {
            if (terraSystem && terraSystem.showSaveStatus) {
                terraSystem.showSaveStatus('saving');
            }
            
            var exportData = {
                metadata: {
                    systemName: "Terra Archive Manager 2.0 Ultimate",
                    version: terraSystem ? terraSystem.version : "fallback",
                    author: terraSystem ? terraSystem.author : "–ê–±–¥—É–∫–∞—Ä–∏–º–æ–≤ –ê–±–¥—É—Ä–∞—à–∏–¥ –ê–±–¥—É–ª—Ö–∞–º–∏—Ç–æ–≤–∏—á",
                    did: terraSystem ? terraSystem.did : "aiuz:did:aiuz:stakeholder:abdukarimov_aaahash1234567890",
                    exportDate: new Date().toISOString(),
                    level: terraSystem ? terraSystem.currentLevel : 0,
                    capabilities: terraSystem ? terraSystem.browserCapabilities : {}
                },
                data: {
                    archives: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.archives : [],
                    thesaurus: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.thesaurus : [],
                    encyclopedia: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.encyclopedia : [],
                    statistics: terraSystem ? terraSystem.integrationStats : {}
                },
                systemInfo: terraSystem && terraSystem.getSystemInfo ? terraSystem.getSystemInfo() : {}
            };
            
            var dataStr = JSON.stringify(exportData, null, 2);
            var dataBlob = new Blob([dataStr], {type: 'application/json'});
            var url = URL.createObjectURL(dataBlob);
            
            var link = document.createElement('a');
            link.href = url;
            link.download = 'terra_ultimate_export_' + new Date().toISOString().slice(0, 10) + '.json';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            if (terraSystem && terraSystem.showSaveStatus) {
                terraSystem.showSaveStatus('saved');
            }
            
            alert('‚úÖ Terra Ultimate –∞—Ä—Ö–∏–≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!\n\n' +
                  '–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ:\n' +
                  'üì¶ –ê—Ä—Ö–∏–≤—ã: ' + exportData.data.archives.length + '\n' +
                  'üìö –ó–∞–ø–∏—Å–∏ —Ç–µ–∑–∞—É—Ä—É—Å–∞: ' + exportData.data.thesaurus.length + '\n' +
                  'üî¨ –ó–∞–ø–∏—Å–∏ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏: ' + exportData.data.encyclopedia.length + '\n' +
                  'üß¨ –£—Ä–æ–≤–µ–Ω—å —Å–∏—Å—Ç–µ–º—ã: L' + (terraSystem ? terraSystem.currentLevel : 0));
        };
        
        window.importUltimateArchive = function() {
            var input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                var file = e.target.files[0];
                if (!file) return;
                
                if (terraSystem && terraSystem.showSaveStatus) {
                    terraSystem.showSaveStatus('saving');
                }
                
                var reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        var importData = JSON.parse(e.target.result);
                        
                        if (importData.metadata && importData.metadata.systemName && 
                            importData.metadata.systemName.includes('Terra')) {
                            
                            // Merge imported data
                            if (importData.data.archives && terraSystem && terraSystem.archiveManager) {
                                terraSystem.archiveManager.archives = terraSystem.archiveManager.archives.concat(importData.data.archives);
                            }
                            if (importData.data.thesaurus && terraSystem && terraSystem.archiveManager) {
                                terraSystem.archiveManager.thesaurus = terraSystem.archiveManager.thesaurus.concat(importData.data.thesaurus);
                            }
                            if (importData.data.encyclopedia && terraSystem && terraSystem.archiveManager) {
                                terraSystem.archiveManager.encyclopedia = terraSystem.archiveManager.encyclopedia.concat(importData.data.encyclopedia);
                            }
                            
                            if (terraSystem && terraSystem.saveAllData) {
                                terraSystem.saveAllData();
                            }
                            if (terraSystem && terraSystem.updateUI) {
                                terraSystem.updateUI();
                            }
                            if (terraSystem && terraSystem.showSaveStatus) {
                                terraSystem.showSaveStatus('saved');
                            }
                            
                            alert('‚úÖ Terra Ultimate –∞—Ä—Ö–∏–≤ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!\n\n' +
                                  '–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ:\n' +
                                  'üì¶ –ê—Ä—Ö–∏–≤—ã: ' + (importData.data.archives ? importData.data.archives.length : 0) + '\n' +
                                  'üìö –ó–∞–ø–∏—Å–∏ —Ç–µ–∑–∞—É—Ä—É—Å–∞: ' + (importData.data.thesaurus ? importData.data.thesaurus.length : 0) + '\n' +
                                  'üî¨ –ó–∞–ø–∏—Å–∏ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏: ' + (importData.data.encyclopedia ? importData.data.encyclopedia.length : 0) + '\n' +
                                  'üìÖ –î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ' + new Date(importData.metadata.exportDate).toLocaleString());
                            
                        } else {
                            alert('‚ùå –§–∞–π–ª –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —ç–∫—Å–ø–æ—Ä—Ç–æ–º Terra Ultimate');
                            if (terraSystem && terraSystem.showSaveStatus) {
                                terraSystem.showSaveStatus('saved');
                            }
                        }
                        
                    } catch (error) {
                        alert('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: ' + error.message);
                        if (terraSystem && terraSystem.showSaveStatus) {
                            terraSystem.showSaveStatus('saved');
                        }
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        };
        
        window.createQuantumBackup = function() {
            if (terraSystem && terraSystem.saveAllData) {
                terraSystem.saveAllData();
            }
            
            var backupData = {
                timestamp: new Date().toISOString(),
                systemLevel: terraSystem ? terraSystem.currentLevel : 0,
                archives: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.archives : [],
                thesaurus: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.thesaurus : [],
                encyclopedia: terraSystem && terraSystem.archiveManager ? terraSystem.archiveManager.encyclopedia : [],
                stats: terraSystem ? terraSystem.integrationStats : {}
            };
            
            // Save to special backup key
            try {
                localStorage.setItem('terra_quantum_backup', JSON.stringify(backupData));
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –±—ç–∫–∞–ø–∞:', error);
            }
            
            alert('‚úÖ –ö–≤–∞–Ω—Ç–æ–≤—ã–π –±—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω!\n\n' +
                  '–í—Ä–µ–º—è: ' + new Date().toLocaleString() + '\n' +
                  '–£—Ä–æ–≤–µ–Ω—å: L' + (terraSystem ? terraSystem.currentLevel : 0) + '\n' +
                  '–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ');
        };
        
        window.runCompatibilityCheck = function() {
            var info = terraSystem && terraSystem.getSystemInfo ? terraSystem.getSystemInfo() : { version: "fallback", currentLevel: 0, componentsLoaded: {}, statistics: {} };
            var caps = terraSystem && terraSystem.browserCapabilities ? terraSystem.browserCapabilities : {};
            
            var report = 'üîç –û–¢–ß–ï–¢ –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–ò TERRA ULTIMATE\n\n';
            
            report += 'üß¨ –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:\n';
            report += '–í–µ—Ä—Å–∏—è: ' + info.version + '\n';
            report += '–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: L' + info.currentLevel + '\n';
            report += '–ê–≤—Ç–æ—Ä: ' + info.author + '\n\n';
            
            report += 'üåê –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –ë–†–ê–£–ó–ï–†–ê:\n';
            report += 'ES3 –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (caps.es3Support ? '‚úÖ' : '‚ùå') + '\n';
            report += 'ES5 –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (caps.es5Support ? '‚úÖ' : '‚ùå') + '\n';
            report += 'ES6 –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ' + (caps.es6Support ? '‚úÖ' : '‚ùå') + '\n';
            report += 'LocalStorage: ' + (caps.localStorageSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += 'IndexedDB: ' + (caps.indexedDBSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Web Workers: ' + (caps.webWorkersSupport ? '‚úÖ' : '‚ùå') + '\n';
            report += '–°–µ–º–µ–π—Å—Ç–≤–æ –±—Ä–∞—É–∑–µ—Ä–∞: ' + caps.browserFamily + '\n';
            report += '–°—Ç–∞—Ä—ã–π –±—Ä–∞—É–∑–µ—Ä: ' + (caps.isOldBrowser ? '‚ö†Ô∏è –î–∞' : '‚úÖ –ù–µ—Ç') + '\n\n';
            
            report += '‚ö° –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:\n';
            report += '–û—Ü–µ–Ω–æ—á–Ω–∞—è RAM: ' + caps.estimatedRAM + ' MB\n';
            report += '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ' + caps.processingPower + '\n';
            report += '–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞: ' + caps.screenSize.width + 'x' + caps.screenSize.height + '\n\n';
            
            report += 'üîß –ö–û–ú–ü–û–ù–ï–ù–¢–´:\n';
            report += 'L0 Kernel: ' + (info.componentsLoaded.l0Kernel ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Offline Analyzer: ' + (info.componentsLoaded.offlineAnalyzer ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Ethical Layer: ' + (info.componentsLoaded.ethicalLayer ? '‚úÖ' : '‚ùå') + '\n';
            report += 'Archive Manager: ' + (info.componentsLoaded.archiveManager ? '‚úÖ' : '‚ùå') + '\n\n';
            
            report += 'üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n';
            report += '–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ' + info.statistics.totalProcessed + '\n';
            report += '–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤: ' + info.statistics.semanticAnalyses + '\n';
            report += '–≠—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + info.statistics.ethicalChecks + '\n';
            report += '–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: ' + info.statistics.archiveOperations + '\n';
            
            if (info.statistics.lastActivity) {
                report += '–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ' + new Date(info.statistics.lastActivity).toLocaleString() + '\n';
            }
            
            alert(report);
        };
        
        // Additional helper functions for UI
        window.generateSemanticMap = function() {
            alert('üß† –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.buildIntegratedThesaurus = function() {
            alert('üìö –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–∑–∞—É—Ä—É—Å–∞\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.extractConcepts = function() {
            alert('üî¨ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.analyzeCorpusWithAI = function() {
            alert('üìñ –ò–ò-–∞–Ω–∞–ª–∏–∑ –∫–æ—Ä–ø—É—Å–∞\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.generateEncyclopedia = function() {
            alert('üåê –°–æ–∑–¥–∞–Ω–∏–µ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏\n\n–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...\n–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Terra Ultimate.');
        };
        
        window.performEthicalAudit = function() {
            var ethicalReport = terraSystem && terraSystem.ethicalLayer && terraSystem.ethicalLayer.generateEthicalReport ? 
                terraSystem.ethicalLayer.generateEthicalReport() : 
                { statistics: { totalChecks: 0, blockedContent: 0, warningsIssued: 0, enhancedContent: 0 }, 
                  filtersActive: { childSafety: 0, detoxification: 0 }, 
                  coreValues: {} };
            var reportText = '‚öñÔ∏è –≠–¢–ò–ß–ï–°–ö–ò–ô –ê–£–î–ò–¢ TERRA ULTIMATE\n\n';
            
            reportText += 'üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–ï–¢–û–ö–°–ò–ö–ê–¶–ò–ò:\n';
            reportText += '–í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: ' + ethicalReport.statistics.totalChecks + '\n';
            reportText += '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ' + ethicalReport.statistics.blockedContent + '\n';
            reportText += '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –≤—ã–¥–∞–Ω–æ: ' + ethicalReport.statistics.warningsIssued + '\n';
            reportText += '–£–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: ' + ethicalReport.statistics.enhancedContent + '\n\n';
            
            reportText += 'üõ°Ô∏è –ê–ö–¢–ò–í–ù–´–ï –§–ò–õ–¨–¢–†–´:\n';
            reportText += '–î–µ—Ç—Å–∫–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ' + ethicalReport.filtersActive.childSafety + ' —Ñ–∏–ª—å—Ç—Ä–æ–≤\n';
            reportText += '–î–µ—Ç–æ–∫—Å–∏–∫–∞—Ü–∏—è: ' + ethicalReport.filtersActive.detoxification + ' —Ñ–∏–ª—å—Ç—Ä–æ–≤\n\n';
            
            reportText += 'üåü –û–°–ù–û–í–ù–´–ï –¶–ï–ù–ù–û–°–¢–ò:\n';
            for (var value in ethicalReport.coreValues) {
                var valueData = ethicalReport.coreValues[value];
                reportText += '‚Ä¢ ' + value + ' (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ' + valueData.priority + '): ' + valueData.description + '\n';
            }
            
            alert(reportText);
        };
        
        window.interpretUserQuery = function() {
            var query = prompt('üß† –í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ Terra –ò–ò:');
            if (!query) return;
            
            var result = "–°–∏—Å—Ç–µ–º–∞ –Ω–µ –≥–æ—Ç–æ–≤–∞";
            if (terraSystem && terraSystem.l0Kernel && terraSystem.l0Kernel.processRequest) {
                var processed = terraSystem.l0Kernel.processRequest(query, terraSystem.did);
                result = processed.suggestedAction || "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞";
            }
            
            alert('üß† –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Ø –ó–ê–ü–†–û–°–ê\n\n' +
                  '–ó–∞–ø—Ä–æ—Å: ' + query + '\n\n' +
                  '–†–µ–∑—É–ª—å—Ç–∞—Ç: ' + result);
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            initializeTerraSystem();
        });
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ JavaScript –∫–æ–¥–∞
        console.log("üåç Terra Archive Manager 2.0 Ultimate JavaScript –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω!");
    </script>
</body>
</html>